<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <script type="text/javascript" src="/js/src/dytitle.js"></script>

  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<meta name="google-site-verification" content="DYS4wW8ApxKb0piV2oZl20bMa8kLxtUKxiPM1JT1ZJo" />


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">
  <script>
    (function(){
        if(''){
            if (prompt('ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½') !== ''){
                alert('ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½');
                history.back();
            }
        }
    })();
  </script>







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "03760df2"
    });
  daovoice('update');
  </script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="python,å­¦ä¹ ç¬”è®°," />





  <link rel="alternate" href="/atom.xml" title="äº‘æ¾ˆã®åšå®¢" type="application/atom+xml" />






<meta name="description" content="ä»ç½‘é¡µçš„åŸºæœ¬ç»“æ„å¼€å§‹è®²è¿°, æ…¢æ…¢ä½¿ç”¨ä¸€äº›ç®€å•çš„å·¥å…·, åšä¸€äº›ç®€å•çš„çˆ¬è™«. è¿˜ä¼šæœ‰ä¸€äº›å°ç»ƒä¹ , è®©ä½ çˆ¬çˆ¬çœŸæ­£çš„äº’è”ç½‘. ä¸‹è½½ç¾å›¾, é€›é€›ç™¾åº¦ç™¾ç§‘, å…¨ç½‘çˆ¬å–ç­‰ç­‰. å½“ä½ æ‡‚å¾—äº†çˆ¬è™«çš„æ¦‚å¿µ, æˆ‘ä»¬åœ¨æ·±å…¥ä¸€äº›, è°ˆè°ˆå¦‚ä½•åŠ é€Ÿä½ é‚£å’Œè •è™«(çˆ¬çš„æ…¢)ä¸€æ ·çš„çˆ¬è™«, æŠŠå®ƒå‡çº§ä¸ºä¸€åªå°é£è™«(å¤šè¿›ç¨‹,å¼‚æ­¥çˆ¬å–). å½“ç„¶è¿™äº›å†…å®¹éƒ½ä¸ä¼šç‰¹åˆ«æ·±å…¥, é‡ç‚¹æ˜¯æŠŠä½ å¸¦å…¥é—¨">
<meta property="og:type" content="article">
<meta property="og:title" content="requestçˆ¬è™«å…¥é—¨">
<meta property="og:url" content="https://liudufu.github.io/Getting_Started_with_Request_Crawler/index.html">
<meta property="og:site_name" content="äº‘æ¾ˆã®åšå®¢">
<meta property="og:description" content="ä»ç½‘é¡µçš„åŸºæœ¬ç»“æ„å¼€å§‹è®²è¿°, æ…¢æ…¢ä½¿ç”¨ä¸€äº›ç®€å•çš„å·¥å…·, åšä¸€äº›ç®€å•çš„çˆ¬è™«. è¿˜ä¼šæœ‰ä¸€äº›å°ç»ƒä¹ , è®©ä½ çˆ¬çˆ¬çœŸæ­£çš„äº’è”ç½‘. ä¸‹è½½ç¾å›¾, é€›é€›ç™¾åº¦ç™¾ç§‘, å…¨ç½‘çˆ¬å–ç­‰ç­‰. å½“ä½ æ‡‚å¾—äº†çˆ¬è™«çš„æ¦‚å¿µ, æˆ‘ä»¬åœ¨æ·±å…¥ä¸€äº›, è°ˆè°ˆå¦‚ä½•åŠ é€Ÿä½ é‚£å’Œè •è™«(çˆ¬çš„æ…¢)ä¸€æ ·çš„çˆ¬è™«, æŠŠå®ƒå‡çº§ä¸ºä¸€åªå°é£è™«(å¤šè¿›ç¨‹,å¼‚æ­¥çˆ¬å–). å½“ç„¶è¿™äº›å†…å®¹éƒ½ä¸ä¼šç‰¹åˆ«æ·±å…¥, é‡ç‚¹æ˜¯æŠŠä½ å¸¦å…¥é—¨">
<meta property="article:published_time" content="2023-08-26T09:58:02.000Z">
<meta property="article:modified_time" content="2023-08-26T09:59:46.250Z">
<meta property="article:author" content="äº‘æ¾ˆ">
<meta property="article:tag" content="python">
<meta property="article:tag" content="å­¦ä¹ ç¬”è®°">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://liudufu.github.io/Getting_Started_with_Request_Crawler/"/>





  <title>requestçˆ¬è™«å…¥é—¨ | äº‘æ¾ˆã®åšå®¢</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '5e442439848b85893d4627c44c1d8971', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	<a href="https://github.com/liudufu" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    
	
	<meta name="google-site-verification" content="DYS4wW8ApxKb0piV2oZl20bMa8kLxtUKxiPM1JT1ZJo" />
	<meta name="baidu-site-verification" content="DPYNeCY4vP" />

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">äº‘æ¾ˆã®åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ä¸ç»å†é£é›¨ï¼Œæ€èƒ½è§å½©è™¹ï¼</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…¬ç›Š404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-top">
          <a href="/top/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-signal"></i> <br />
            
            TopX
          </a>
        </li>
      
        
        <li class="menu-item menu-item-resources">
          <a href="/resources/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            resources
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="æœç´¢..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liudufu.github.io/Getting_Started_with_Request_Crawler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="äº‘æ¾ˆ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://s1.ax1x.com/2020/07/20/UfbOPJ.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘æ¾ˆã®åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">requestçˆ¬è™«å…¥é—¨</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2023-08-26T17:58:02+08:00">
                2023-08-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®æŒ–æ˜</span>
                  </a>
                </span>

                
                
                  ï¼Œ 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">å­¦ä¹ ç¬”è®°</span>
                  </a>
                </span>

                
                
              
            </span>
          
		  
		  

          
            
          

          
          
             <span id="/Getting_Started_with_Request_Crawler/" class="leancloud_visitors" data-flag-title="requestçˆ¬è™«å…¥é—¨">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">çƒ­åº¦&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
				 <span>â„ƒ</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  11.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  46
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>ä»ç½‘é¡µçš„åŸºæœ¬ç»“æ„å¼€å§‹è®²è¿°, æ…¢æ…¢ä½¿ç”¨ä¸€äº›ç®€å•çš„å·¥å…·, åšä¸€äº›ç®€å•çš„çˆ¬è™«. è¿˜ä¼šæœ‰ä¸€äº›å°ç»ƒä¹ , è®©ä½ çˆ¬çˆ¬çœŸæ­£çš„äº’è”ç½‘. ä¸‹è½½ç¾å›¾, é€›é€›ç™¾åº¦ç™¾ç§‘, å…¨ç½‘çˆ¬å–ç­‰ç­‰. å½“ä½ æ‡‚å¾—äº†çˆ¬è™«çš„æ¦‚å¿µ, æˆ‘ä»¬åœ¨æ·±å…¥ä¸€äº›, è°ˆè°ˆå¦‚ä½•åŠ é€Ÿä½ é‚£å’Œè •è™«(çˆ¬çš„æ…¢)ä¸€æ ·çš„çˆ¬è™«, æŠŠå®ƒå‡çº§ä¸ºä¸€åªå°é£è™«(å¤šè¿›ç¨‹,å¼‚æ­¥çˆ¬å–). å½“ç„¶è¿™äº›å†…å®¹éƒ½ä¸ä¼šç‰¹åˆ«æ·±å…¥, é‡ç‚¹æ˜¯æŠŠä½ å¸¦å…¥é—¨</p>
</blockquote>
<a id="more"></a>

<h2 id="ğŸŒ¸requestçˆ¬è™«å…¥é—¨"><a href="#ğŸŒ¸requestçˆ¬è™«å…¥é—¨" class="headerlink" title="ğŸŒ¸requestçˆ¬è™«å…¥é—¨"></a>ğŸŒ¸requestçˆ¬è™«å…¥é—¨</h2><blockquote>
<p>ä»ç½‘é¡µçš„åŸºæœ¬ç»“æ„å¼€å§‹è®²è¿°, æ…¢æ…¢ä½¿ç”¨ä¸€äº›ç®€å•çš„å·¥å…·, åšä¸€äº›ç®€å•çš„çˆ¬è™«. è¿˜ä¼šæœ‰ä¸€äº›å°ç»ƒä¹ , è®©ä½ çˆ¬çˆ¬çœŸæ­£çš„äº’è”ç½‘. ä¸‹è½½ç¾å›¾, é€›é€›ç™¾åº¦ç™¾ç§‘, å…¨ç½‘çˆ¬å–ç­‰ç­‰. å½“ä½ æ‡‚å¾—äº†çˆ¬è™«çš„æ¦‚å¿µ, æˆ‘ä»¬åœ¨æ·±å…¥ä¸€äº›, è°ˆè°ˆå¦‚ä½•åŠ é€Ÿä½ é‚£å’Œè •è™«(çˆ¬çš„æ…¢)ä¸€æ ·çš„çˆ¬è™«, æŠŠå®ƒå‡çº§ä¸ºä¸€åªå°é£è™«(å¤šè¿›ç¨‹,å¼‚æ­¥çˆ¬å–). å½“ç„¶è¿™äº›å†…å®¹éƒ½ä¸ä¼šç‰¹åˆ«æ·±å…¥, é‡ç‚¹æ˜¯æŠŠä½ å¸¦å…¥é—¨</p>
</blockquote>
<h3 id="ç®€å•çš„ç½‘é¡µç»“æ„"><a href="#ç®€å•çš„ç½‘é¡µç»“æ„" class="headerlink" title="ç®€å•çš„ç½‘é¡µç»“æ„"></a>ç®€å•çš„ç½‘é¡µç»“æ„</h3><p>åœ¨ HTML ä¸­, åŸºæœ¬ä¸Šæ‰€æœ‰çš„å®ä½“å†…å®¹, éƒ½ä¼šæœ‰ä¸ª tag æ¥æ¡†ä½å®ƒ. è€Œè¿™ä¸ªè¢« tag ä½çš„å†…å®¹, å°±å¯ä»¥è¢«å±•ç¤ºæˆä¸åŒçš„å½¢å¼, æˆ–æœ‰ä¸åŒçš„åŠŸèƒ½. ä¸»ä½“çš„ tag åˆ†æˆä¸¤éƒ¨åˆ†, <code>header</code> å’Œ <code>body</code>. åœ¨ <code>header</code> ä¸­, å­˜æ”¾è¿™ä¸€äº›ç½‘é¡µçš„ç½‘é¡µçš„å…ƒä¿¡æ¯, æ¯”å¦‚è¯´ <code>title</code>, è¿™äº›ä¿¡æ¯æ˜¯ä¸ä¼šè¢«æ˜¾ç¤ºåˆ°ä½ çœ‹åˆ°çš„ç½‘é¡µä¸­çš„. è¿™äº›ä¿¡æ¯å¤§å¤šæ•°æ—¶å€™æ˜¯ç»™æµè§ˆå™¨çœ‹, æˆ–è€…æ˜¯ç»™æœç´¢å¼•æ“çš„çˆ¬è™«çœ‹</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;äº‘æ¾ˆã®åšå®¢&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">"icon"</span> href=<span class="string">"https://liudufu.github.io/"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>HTML çš„ç¬¬äºŒå¤§å—æ˜¯ <code>body</code>, è¿™ä¸ªéƒ¨åˆ†æ‰æ˜¯ä½ çœ‹åˆ°çš„ç½‘é¡µä¿¡æ¯. ç½‘é¡µä¸­çš„ <code>heading</code>, è§†é¢‘, å›¾ç‰‡å’Œæ–‡å­—ç­‰éƒ½å­˜æ”¾åœ¨è¿™é‡Œ. è¿™é‡Œçš„ <code>&lt;h1&gt;&lt;/h1&gt;</code> tag å°±æ˜¯ä¸»æ ‡é¢˜, æˆ‘ä»¬çœ‹åˆ°å‘ˆç°å‡ºæ¥çš„æ•ˆæœå°±æ˜¯å¤§ä¸€å·çš„æ–‡å­—. <code>&lt;p&gt;&lt;/p&gt;</code> é‡Œé¢çš„æ–‡å­—å°±æ˜¯ä¸€ä¸ªæ®µè½. <code>&lt;a&gt;&lt;/a&gt;</code>é‡Œé¢éƒ½æ˜¯ä¸€äº›é“¾æ¥. æ‰€ä»¥å¾ˆå¤šæƒ…å†µ, ä¸œè¥¿éƒ½æ˜¯æ”¾åœ¨è¿™äº› tag ä¸­çš„.</p>
<h3 id="ç”¨-Python-ç™»å½•ç½‘é¡µ"><a href="#ç”¨-Python-ç™»å½•ç½‘é¡µ" class="headerlink" title="ç”¨ Python ç™»å½•ç½‘é¡µ"></a>ç”¨ Python ç™»å½•ç½‘é¡µ</h3><p>å¥½äº†, å¯¹ç½‘é¡µç»“æ„å’Œ HTML æœ‰äº†ä¸€äº›åŸºæœ¬è®¤è¯†ä»¥å, æˆ‘ä»¬å°±èƒ½ç”¨ Python æ¥çˆ¬å–è¿™ä¸ª<a href="https://mofanpy.com/static/scraping/basic-structure.html" target="_blank" rel="noopener">ç½‘é¡µ</a>çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯. é¦–å…ˆè¦åšçš„, æ˜¯ä½¿ç”¨ Python æ¥ç™»å½•è¿™ä¸ªç½‘é¡µ, å¹¶æ‰“å°å‡ºè¿™ä¸ªç½‘é¡µ HTML çš„ source code. æ³¨æ„, å› ä¸ºç½‘é¡µä¸­å­˜åœ¨ä¸­æ–‡, ä¸ºäº†æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡, <code>read()</code> å®Œä»¥å, æˆ‘ä»¬è¦å¯¹è¯»å‡ºæ¥çš„æ–‡å­—è¿›è¡Œè½¬æ¢, <code>decode()</code> æˆå¯ä»¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡çš„å½¢å¼.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"></span><br><span class="line"><span class="comment"># if has Chinese, apply decode()</span></span><br><span class="line">html = urlopen(</span><br><span class="line">    <span class="string">"https://liudufu.github.io/"</span></span><br><span class="line">).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">print(html)</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬èƒ½å¤ŸæˆåŠŸè¯»å–è¿™ä¸ªç½‘é¡µçš„æ‰€æœ‰ä¿¡æ¯äº†. ä½†æˆ‘ä»¬è¿˜æ²¡æœ‰å¯¹ç½‘é¡µçš„ä¿¡æ¯è¿›è¡Œæ±‡æ€»å’Œåˆ©ç”¨. æˆ‘ä»¬å‘ç°, æƒ³è¦æå–ä¸€äº›å½¢å¼çš„ä¿¡æ¯, åˆç†çš„åˆ©ç”¨ tag çš„åå­—ååˆ†é‡è¦.</p>
<h3 id="åŒ¹é…ç½‘é¡µå†…å®¹"><a href="#åŒ¹é…ç½‘é¡µå†…å®¹" class="headerlink" title="åŒ¹é…ç½‘é¡µå†…å®¹"></a>åŒ¹é…ç½‘é¡µå†…å®¹</h3><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Python çš„æ­£åˆ™è¡¨è¾¾å¼ RegEx è¿›è¡ŒåŒ¹é…æ–‡å­—, ç­›é€‰ä¿¡æ¯çš„å·¥ä½œ. å¦‚æœæ˜¯åˆçº§çš„ç½‘é¡µåŒ¹é…, æˆ‘ä»¬ä½¿ç”¨æ­£åˆ™å®Œå…¨å°±å¯ä»¥äº†, é«˜çº§ä¸€ç‚¹æˆ–è€…æ¯”è¾ƒç¹ççš„åŒ¹é…, æˆ‘è¿˜æ˜¯æ¨èä½¿ç”¨ <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank" rel="noopener">BeautifulSoup</a>. ä¸æ€¥ä¸æ€¥, æˆ‘çŸ¥é“ä½ æƒ³å·æ‡’, æˆ‘ä¹‹åé©¬ä¸Šå°±ä¼šæ•™ beautiful soup äº†. ä½†æ˜¯ç°åœ¨æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨æ­£åˆ™æ¥åšå‡ ä¸ªç®€å•çš„ä¾‹å­, è®©ä½ ç†Ÿæ‚‰ä¸€ä¸‹å¥—è·¯.</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³ç”¨ä»£ç æ‰¾åˆ°è¿™ä¸ªç½‘é¡µçš„ title, æˆ‘ä»¬å°±èƒ½è¿™æ ·å†™. é€‰å¥½è¦ä½¿ç”¨çš„ tag åç§° <code>&lt;title&gt;</code>. ä½¿ç”¨æ­£åˆ™åŒ¹é….</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">res = re.findall(<span class="string">r"&lt;title&gt;(.+?)&lt;/title&gt;"</span>, html)</span><br><span class="line">print(<span class="string">"\nPage title is: "</span>, res[<span class="number">0</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæƒ³è¦æ‰¾åˆ°ä¸­é—´çš„é‚£ä¸ªæ®µè½ <code>&lt;p&gt;</code>, æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢æ–¹æ³•, å› ä¸ºè¿™ä¸ªæ®µè½åœ¨ HTML ä¸­è¿˜å¤¹æ‚ç€ tab, new line, æ‰€ä»¥æˆ‘ä»¬ç»™ä¸€ä¸ª <code>flags=re.DOTALL</code> æ¥å¯¹è¿™äº› tab, new line ä¸æ•æ„Ÿ.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = re.findall(<span class="string">r"&lt;p&gt;(.*?)&lt;/p&gt;"</span>, html, flags=re.DOTALL)    <span class="comment"># re.DOTALL if multi line</span></span><br><span class="line">print(<span class="string">"\nPage paragraph is: "</span>, res[<span class="number">0</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>æœ€åä¸€ä¸ªç»ƒä¹ æ˜¯æ‰¾ä¸€æ‰¾æ‰€æœ‰çš„é“¾æ¥, è¿™ä¸ªæ¯”è¾ƒæœ‰ç”¨, æœ‰æ—¶å€™ä½ æƒ³æ‰¾åˆ°ç½‘é¡µé‡Œçš„é“¾æ¥, ç„¶åä¸‹è½½ä¸€äº›å†…å®¹åˆ°ç”µè„‘é‡Œ, å°±é è¿™æ ·çš„é€”å¾„</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = re.findall(<span class="string">r'href="(.*?)"'</span>, html)</span><br><span class="line">print(<span class="string">"\nAll links: "</span>, res)</span><br></pre></td></tr></tbody></table></figure>



<h3 id="BeautifulSoupåŸºç¡€"><a href="#BeautifulSoupåŸºç¡€" class="headerlink" title="BeautifulSoupåŸºç¡€"></a>BeautifulSoupåŸºç¡€</h3><p>æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹çˆ¬ç½‘é¡µçš„æµç¨‹, è®©ä½ å¯¹ BeautifulSoup æœ‰ä¸€ä¸ªæ›´å¥½çš„å®šä½.</p>
<ol>
<li>é€‰ç€è¦çˆ¬çš„ç½‘å€ (url)</li>
<li>ä½¿ç”¨ python ç™»å½•ä¸Šè¿™ä¸ªç½‘å€ (urlopenç­‰)</li>
<li>è¯»å–ç½‘é¡µä¿¡æ¯ (read() å‡ºæ¥)</li>
<li><strong>å°†è¯»å–çš„ä¿¡æ¯æ”¾å…¥ BeautifulSoup</strong></li>
<li><strong>ä½¿ç”¨ BeautifulSoup é€‰å– tag ä¿¡æ¯ç­‰ (ä»£æ›¿æ­£åˆ™è¡¨è¾¾å¼)</strong></li>
</ol>
<p>åˆå­¦çš„æ—¶å€™æ€»æ˜¯æä¸æ‡‚è¿™äº›åŒ…æ˜¯å¹²ä»€ä¹ˆçš„, ç°åœ¨ä½ å°±èƒ½ç†è§£è¿™ä¸ª BeautifulSoup åˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„äº†.</p>
<p>BeautifulSoup ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•, æˆ‘ä»¬å…ˆæŒ‰å¸¸è§„è¯»å–ç½‘é¡µ</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"></span><br><span class="line"><span class="comment"># if has Chinese, apply decode()</span></span><br><span class="line">html = urlopen(<span class="string">"url"</span>).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">print(html)</span><br></pre></td></tr></tbody></table></figure>

<p>æ¯å¼ ç½‘é¡µä¸­, éƒ½æœ‰ä¸¤å¤§å—, ä¸€ä¸ªæ˜¯ <code>&lt;head&gt;</code>, ä¸€ä¸ªæ˜¯ <code>&lt;body&gt;</code>, æˆ‘ä»¬ç­‰ä¼šç”¨ <code>BeautifulSoup</code> æ¥æ‰¾åˆ° body ä¸­çš„æ®µè½ <code>&lt;p&gt;</code> å’Œæ‰€æœ‰é“¾æ¥ <code>&lt;a&gt;</code>.</p>
<p>è¯»å–è¿™ä¸ªç½‘é¡µä¿¡æ¯, æˆ‘ä»¬å°†è¦åŠ è½½è¿› <code>BeautifulSoup</code>, ä»¥ <code>lxml</code> çš„è¿™ç§å½¢å¼åŠ è½½. é™¤äº† <code>lxml</code>, å…¶å®è¿˜æœ‰<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id9" target="_blank" rel="noopener">å¾ˆå¤šå½¢å¼çš„è§£æå™¨</a>, ä¸è¿‡å¤§å®¶éƒ½æ¨èä½¿ç”¨ <code>lxml</code> çš„å½¢å¼. ç„¶å <code>soup</code> é‡Œé¢å°±æœ‰ç€è¿™ä¸ª HTML çš„æ‰€æœ‰ä¿¡æ¯. å¦‚æœä½ è¦è¾“å‡º <code>&lt;h1&gt;</code> æ ‡é¢˜, å¯ä»¥å°±ç›´æ¥ <code>soup.h1</code>.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(html, features=<span class="string">'lxml'</span>)</span><br><span class="line">print(soup.h1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'\n'</span>, soup.p)</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœç½‘é¡µä¸­æœ‰å¤šä¸ªåŒæ ·çš„ tag, æ¯”å¦‚é“¾æ¥ <code>&lt;a&gt;</code>, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>find_all()</code> æ¥æ‰¾åˆ°æ‰€æœ‰çš„é€‰é¡¹. å› ä¸ºæˆ‘ä»¬çœŸæ­£çš„ link ä¸æ˜¯åœ¨ <code>&lt;a&gt;</code> ä¸­é—´ <code>&lt;/a&gt;</code>, è€Œæ˜¯åœ¨ <code>&lt;a href="link"&gt;</code> é‡Œé¢, ä¹Ÿå¯ä»¥çœ‹åšæ˜¯ <code>&lt;a&gt;</code> çš„ä¸€ä¸ªå±æ€§. æˆ‘ä»¬èƒ½ç”¨åƒ Python å­—å…¸çš„å½¢å¼, ç”¨ key æ¥è¯»å– <code>l["href"]</code>.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">all_href = soup.find_all(<span class="string">'a'</span>)</span><br><span class="line">all_href = [l[<span class="string">'href'</span>] <span class="keyword">for</span> l <span class="keyword">in</span> all_href]</span><br><span class="line">print(<span class="string">'\n'</span>, all_href)</span><br></pre></td></tr></tbody></table></figure>

<p>æ‡‚å¾—è¿™äº›è¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„, çœŸå®æƒ…å†µå¾€å¾€æ¯”è¿™äº›å¤æ‚. <code>BeautifulSoup</code> è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„é€‰æ‹©å¢å¼ºå™¨. æ¥ä¸‹æ¥, æˆ‘ä»¬æ¥äº†è§£ä¸€äº› CSS çš„æ¦‚å¿µ, ç”¨ <code>BeautifulSoup</code> åŠ ä¸Š CSS æ¥é€‰æ‹©å†…å®¹.</p>
<h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><p>CSS ä¸»è¦ç”¨é€”å°±æ˜¯è£…é¥°ä½  éª¨æ„Ÿ HTML é¡µé¢. å¦‚æœå°† HTML æ¯”å–»æˆæ²¡ç©¿è¡£æœçš„äºº, é‚£ CSS å°±æ˜¯äº”é¢œå…­è‰²çš„è¡£æœ. ç©¿åœ¨äººèº«ä¸Šè®©äººæœ‰äº†æ°”è´¨. CSS çš„è§„åˆ™å¾ˆå¤š, å¥½åœ¨å¦‚æœä½ åªæ˜¯éœ€è¦çˆ¬ç½‘é¡µ, ä½ å¹¶ä¸éœ€è¦å­¦ä¹  CSS çš„è¿™äº›ç”¨æ³•æˆ–è§„åˆ™, (å¦‚æœä½ æƒ³, ä½ å¯ä»¥çœ‹åˆ°<a href="https://www.w3schools.com/css/" target="_blank" rel="noopener">è¿™é‡Œ</a>), ä½ åªéœ€è¦æ³¨æ„ CSS çš„ä¸€æ¡è§„åˆ™å°±èƒ½ç©è½¬çˆ¬è™«äº†.</p>
<h4 id="CSS-çš„-Class"><a href="#CSS-çš„-Class" class="headerlink" title="CSS çš„ Class"></a>CSS çš„ Class</h4><p>è¿™æ¡è§„åˆ™å°±æ˜¯ CSS çš„ Class, CSS åœ¨è£…é¥°æ¯ä¸€ä¸ªç½‘é¡µéƒ¨ä»¶çš„æ—¶å€™, éƒ½ä¼šç»™å®ƒä¸€ä¸ªåå­—. è€Œä¸”ä¸€ä¸ªç±»å‹çš„éƒ¨ä»¶, åå­—éƒ½å¯ä»¥ä¸€æ ·. æ¯”å¦‚æ¯ä¸ªç½‘é¡µ é‡Œé¢çš„å­—ä½“/èƒŒæ™¯é¢œè‰², å­—ä½“å¤§å°, éƒ½æ˜¯ç”± CSS æ¥æŒæ§çš„.</p>
<p>è€Œ CSS çš„ä»£ç , å¯èƒ½å°±ä¼šæ”¾åœ¨è¿™ä¸ªç½‘é¡µçš„ <code>&lt;head&gt;</code> ä¸­. æˆ‘ä»¬å…ˆä½¿ç”¨ Python è¯»å–è¿™ä¸ªé¡µé¢.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"></span><br><span class="line"><span class="comment"># if has Chinese, apply decode()</span></span><br><span class="line">html = urlopen(<span class="string">"URL"</span>).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">print(html)</span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨ <code>&lt;head&gt;</code> ä¸­, ä½ ä¼šå‘ç°æœ‰è¿™æ ·ä¸€äº›ä¸œè¥¿è¢«æ”¾åœ¨ <code>&lt;style&gt;</code> é‡Œé¢, è¿™äº›ä¸œè¥¿éƒ½æ˜¯æŸäº› class çš„ CSS ä»£ç . æ¯”å¦‚ <code>jan</code> å°±æ˜¯ä¸€ä¸ª class. <code>jan</code> è¿™ä¸ªç±»æŒæ§äº†è¿™ä¸ªç±»å‹çš„èƒŒæ™¯é¢œè‰². æ‰€ä»¥åœ¨ <code>&lt;ul class="jan"&gt;</code> è¿™é‡Œ, è¿™ä¸ª ul çš„èƒŒæ™¯é¢œè‰²å°±æ˜¯é»„è‰²çš„. è€Œå¦‚æœæ˜¯ <code>month</code> è¿™ä¸ªç±», å®ƒä»¬çš„å­—ä½“é¢œè‰²å°±æ˜¯çº¢è‰².</p>
<h4 id="æŒ‰-Class-åŒ¹é…"><a href="#æŒ‰-Class-åŒ¹é…" class="headerlink" title="æŒ‰ Class åŒ¹é…"></a>æŒ‰ Class åŒ¹é…</h4><p> Class åŒ¹é…å¾ˆç®€å•. æ¯”å¦‚æˆ‘è¦æ‰¾æ‰€æœ‰ class=month çš„ä¿¡æ¯. å¹¶æ‰“å°å‡ºå®ƒä»¬çš„ tag å†…æ–‡å­—.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(html, features=<span class="string">'lxml'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># use class to narrow search</span></span><br><span class="line">month = soup.find_all(<span class="string">'li'</span>, {<span class="string">"class"</span>: <span class="string">"month"</span>})</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> month:</span><br><span class="line">    print(m.get_text())</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ–è€…æ‰¾åˆ° class=jan çš„ä¿¡æ¯. ç„¶ååœ¨ <code>&lt;ul&gt;</code> ä¸‹é¢ç»§ç»­æ‰¾ <code>&lt;ul&gt;</code> å†…éƒ¨çš„ <code>&lt;li&gt;</code> ä¿¡æ¯. è¿™æ ·ä¸€å±‚å±‚åµŒå¥—çš„ä¿¡æ¯, éå¸¸å®¹æ˜“æ‰¾åˆ°.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jan = soup.find(<span class="string">'ul'</span>, {<span class="string">"class"</span>: <span class="string">'jan'</span>})</span><br><span class="line">d_jan = jan.find_all(<span class="string">'li'</span>)              <span class="comment"># use jan as a parent</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> d_jan:</span><br><span class="line">    print(d.get_text())</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæƒ³è¦æ‰¾åˆ°ä¸€äº›æœ‰ç€ä¸€å®šæ ¼å¼çš„ä¿¡æ¯, æ¯”å¦‚ä½¿ç”¨æ­£åˆ™è¡¨è¾¾æ¥å¯»æ‰¾ç›¸ç±»ä¼¼çš„ä¿¡æ¯, æˆ‘ä»¬åœ¨ BeautifulSoup ä¸­ä¹Ÿèƒ½åµŒå…¥æ­£åˆ™è¡¨è¾¾å¼</p>
<h3 id="åµŒå…¥æ­£åˆ™"><a href="#åµŒå…¥æ­£åˆ™" class="headerlink" title="åµŒå…¥æ­£åˆ™"></a>åµŒå…¥æ­£åˆ™</h3><p>æ¯”å¦‚ä½ æƒ³ä¸‹è½½é¡µé¢çš„å›¾ç‰‡, æˆ‘ä»¬å°±å¯ä»¥å°†å›¾ç‰‡å½¢å¼çš„ url ä¸ªåŒ¹é…å‡ºæ¥. ä¹‹åå†ä¸‹è½½å°±ç®€å•å¤šäº†</p>
<h4 id="æ­£åˆ™åŒ¹é…"><a href="#æ­£åˆ™åŒ¹é…" class="headerlink" title="æ­£åˆ™åŒ¹é…"></a>æ­£åˆ™åŒ¹é…</h4><p>æˆ‘ä»¬å…ˆè¯»å–è¿™ä¸ªç½‘é¡µ. å¯¼å…¥æ­£åˆ™æ¨¡å— <code>re</code>.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># if has Chinese, apply decode()</span></span><br><span class="line">html = urlopen(<span class="string">"URL"</span>).read().decode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæ˜¯å›¾ç‰‡, å®ƒä»¬éƒ½è—åœ¨è¿™æ ·ä¸€ä¸ª tag ä¸­:</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;</span><br><span class="line">    &lt;img src=<span class="string">"tf.jpg"</span>&gt;</span><br><span class="line">&lt;/td&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰€ä»¥, æˆ‘ä»¬å¯ä»¥ç”¨ <code>soup</code> å°†è¿™äº› <code>&lt;img&gt;</code> tag å…¨éƒ¨æ‰¾å‡ºæ¥, ä½†æ˜¯æ¯ä¸€ä¸ª img çš„é“¾æ¥(src)éƒ½å¯èƒ½ä¸åŒ. æˆ–è€…æ¯ä¸€ä¸ªå›¾ç‰‡æœ‰çš„å¯èƒ½æ˜¯ jpg æœ‰çš„æ˜¯ png, å¦‚æœæˆ‘ä»¬åªæƒ³æŒ‘é€‰ jpg å½¢å¼çš„å›¾ç‰‡, æˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™æ ·ä¸€ä¸ªæ­£åˆ™ <code>r'.*?\.jpg'</code> æ¥é€‰å–. æŠŠæ­£åˆ™çš„ compile å½¢å¼æ”¾åˆ° <code>BeautifulSoup</code> çš„åŠŸèƒ½ä¸­, å°±èƒ½é€‰åˆ°ç¬¦åˆè¦æ±‚çš„å›¾ç‰‡é“¾æ¥äº†.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(html, features=<span class="string">'lxml'</span>)</span><br><span class="line"></span><br><span class="line">img_links = soup.find_all(<span class="string">"img"</span>, {<span class="string">"src"</span>: re.compile(<span class="string">'.*?\.jpg'</span>)})</span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> img_links:</span><br><span class="line">    print(link[<span class="string">'src'</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>åˆæˆ–è€…æˆ‘ä»¬å‘ç°, æˆ‘æƒ³é€‰ä¸€äº›è¯¾ç¨‹çš„é“¾æ¥, è€Œè¿™äº›é“¾æ¥éƒ½æœ‰ç»Ÿä¸€çš„å½¢å¼, å°±æ˜¯å¼€å¤´éƒ½ä¼šæœ‰ <code>https://.</code>, é‚£æˆ‘å°±å°†è¿™ä¸ªå®šä¸ºä¸€ä¸ªæ­£åˆ™çš„è§„åˆ™, è®© BeautifulSoup å¸®æˆ‘æ‰¾åˆ°ç¬¦åˆè¿™ä¸ªè§„åˆ™çš„é“¾æ¥.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">course_links = soup.find_all(<span class="string">'a'</span>, {<span class="string">'href'</span>: re.compile(<span class="string">'/tutorials/.*'</span>)})</span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> course_links:</span><br><span class="line">    print(link[<span class="string">'href'</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ¥åšä¸€ä¸ªå°å®æˆ˜, è®©æˆ‘ä»¬çš„çˆ¬è™«åœ¨ç™¾åº¦ç™¾ç§‘ä¸Šè‡ªç”±çˆ¬è¡Œ, åœ¨å„ä¸ªç™¾ç§‘ç½‘é¡µä¸Šè·³æ¥è·³å»</p>
<h3 id="çˆ¬ç™¾åº¦ç™¾ç§‘"><a href="#çˆ¬ç™¾åº¦ç™¾ç§‘" class="headerlink" title="çˆ¬ç™¾åº¦ç™¾ç§‘"></a>çˆ¬ç™¾åº¦ç™¾ç§‘</h3><blockquote>
<p>çˆ¬ä¸€çˆ¬ç™¾åº¦ç™¾ç§‘, è®©æˆ‘ä»¬çš„çˆ¬è™«ä» ç½‘ç»œçˆ¬è™« è¿™ä¸€é¡µå¼€å§‹çˆ¬, ç„¶ååœ¨é¡µé¢ä¸­å¯»æ‰¾å…¶ä»–é¡µé¢çš„ä¿¡æ¯, ç„¶åçˆ¬å»å…¶ä»–é¡µé¢, ç„¶åå¾ªç¯è¿™ä¹ˆåš, çœ‹çœ‹æœ€åæˆ‘ä»¬çš„çˆ¬è™«åˆ°åº•çˆ¬å»äº†å“ª</p>
</blockquote>
<h4 id="ç™¾åº¦ç™¾ç§‘"><a href="#ç™¾åº¦ç™¾ç§‘" class="headerlink" title="ç™¾åº¦ç™¾ç§‘"></a>ç™¾åº¦ç™¾ç§‘</h4><p>ç™¾åº¦ç™¾ç§‘ä¸­æœ‰å¾ˆå¤šåè¯çš„è§£é‡Šä¿¡æ¯, æˆ‘ä»¬ä»Šå¤©ä» ç½‘é¡µçˆ¬è™« çš„è¯æ¡å¼€å§‹çˆ¬, ç„¶ååœ¨é¡µé¢ä¸­ä»»æ„å¯»æ‰¾ä¸‹ä¸€ä¸ªè¯æ¡, çˆ¬è¿‡å», å†å¯»æ‰¾è¯æ¡, ç»§ç»­çˆ¬. çœ‹çœ‹æœ€åæˆ‘ä»¬çˆ¬åˆ°çš„è¯æ¡å’Œ ç½‘é¡µçˆ¬è™« å·®åˆ«æœ‰å¤šå¤§.</p>
<h4 id="è§‚çœ‹è§„å¾‹"><a href="#è§‚çœ‹è§„å¾‹" class="headerlink" title="è§‚çœ‹è§„å¾‹"></a>è§‚çœ‹è§„å¾‹</h4><p>20+è¡Œä»£ç . ä½†æ˜¯å´èƒ½è®©å®ƒæ¸¸èµ°åœ¨ç™¾åº¦ç™¾ç§‘çš„çŸ¥è¯†çš„æµ·æ´‹ä¸­. é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªèµ·å§‹ç½‘é¡µ, æˆ‘é€‰æ‹©äº† <a href="https://baike.baidu.com/item/ç½‘ç»œçˆ¬è™«/5162711" target="_blank" rel="noopener">ç½‘é¡µçˆ¬è™«</a>. æˆ‘ä»¬å‘ç°, é¡µé¢ä¸­æœ‰ä¸€äº›é“¾æ¥, æŒ‡å‘ç™¾åº¦ç™¾ç§‘ä¸­çš„å¦å¤–ä¸€äº›è¯æ¡, æ¯”å¦‚è¯´ä¸‹é¢è¿™æ ·.</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a target="_blank" href="/item/%E8%9C%98%E8%9B%9B/8135707" data-lemmaid="8135707"&gt;èœ˜è››&lt;/a&gt;</span><br><span class="line">&lt;a target="_blank" href="/item/%E8%A0%95%E8%99%AB"&gt;è •è™«&lt;/a&gt;</span><br><span class="line">&lt;a target="_blank" href="/item/%E9%80%9A%E7%94%A8%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E"&gt;é€šç”¨æœç´¢å¼•æ“&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>é€šè¿‡è§‚å¯Ÿ, æˆ‘ä»¬å‘ç°, é“¾æ¥æœ‰äº›å…±é€šä¹‹å¤„. å®ƒä»¬éƒ½æ˜¯ <code>/item/</code> å¼€å¤´, å¤¹æ‚ç€ä¸€äº› <code>%E9</code> è¿™æ ·çš„ä¸œè¥¿. ä½†æ˜¯ä»”ç»†æœç´¢ä¸€ä¸‹, å‘ç°è¿˜æœ‰ä¸€äº›ä»¥ <code>/item/</code> å¼€å¤´çš„, å´ä¸æ˜¯è¯æ¡. æ¯”å¦‚</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href="/item/å²è®°Â·2016?fr=navbar" target="_blank"&gt;å²è®°Â·2016&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure>

<p> æˆ‘ä»¬éœ€è¦å¯¹è¿™äº›é“¾æ¥åšä¸€äº›ç­›é€‰, ä¹‹å‰æåˆ° çš„ç”¨ <code>BeautifulSoup</code> å’Œ æ­£åˆ™è¡¨è¾¾å¼æ¥ç­›é€‰åº”è¯¥ç”¨å¾—ä¸Š. æœ‰äº†äº›æ€è·¯, æˆ‘ä»¬å¼€å§‹å†™ä»£ç å§.</p>
<h4 id="åˆ¶ä½œçˆ¬è™«"><a href="#åˆ¶ä½œçˆ¬è™«" class="headerlink" title="åˆ¶ä½œçˆ¬è™«"></a>åˆ¶ä½œçˆ¬è™«</h4><p>å¯¼å…¥ä¸€äº›æ¨¡å—, è®¾ç½®èµ·å§‹é¡µ. å¹¶å°† <code>/item/...</code> çš„ç½‘é¡µéƒ½æ”¾åœ¨ <code>his</code> ä¸­, åšä¸€ä¸ªå¤‡æ¡ˆ, è®°å½•æˆ‘ä»¬æµè§ˆè¿‡çš„ç½‘é¡µ.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_url = <span class="string">"https://baike.baidu.com"</span></span><br><span class="line">his = [<span class="string">"/item/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/5162711"</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>æ¥ç€æˆ‘ä»¬å…ˆä¸ç”¨å¾ªç¯, å¯¹ä¸€ä¸ªç½‘é¡µè¿›è¡Œå¤„ç†, èµ°ä¸€éæµç¨‹, ç„¶ååŠ ä¸Šå¾ªç¯, è®©æˆ‘ä»¬çš„çˆ¬è™«èƒ½åœ¨å¾ˆå¤šç½‘é¡µä¸­çˆ¬å–. ä¸‹é¢åšçš„äº‹æƒ…, æ˜¯ä¸ºäº†åœ¨å±å¹•ä¸Šæ‰“å°å‡ºæ¥æˆ‘ä»¬ç°åœ¨æ­£åœ¨å“ªå¼ ç½‘é¡µä¸Š, ç½‘é¡µçš„åå­—å«ä»€ä¹ˆ.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = base_url + his[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">html = urlopen(url).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">soup = BeautifulSoup(html, features=<span class="string">'lxml'</span>)</span><br><span class="line">print(soup.find(<span class="string">'h1'</span>).get_text(), <span class="string">'    url: '</span>, his[<span class="number">-1</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹åœ¨è¿™ä¸ªç½‘é¡µä¸Šæ‰¾æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„ <code>/item/</code> ç½‘å€. ä½¿ç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼(<a href="https://mofanpy.com/tutorials/python-basic/basic/regular-expression" target="_blank" rel="noopener">æ­£åˆ™æ•™ç¨‹</a>) è¿‡æ»¤æ‰ä¸æƒ³è¦çš„ç½‘å€å½¢å¼. è¿™æ ·æˆ‘ä»¬æ‰¾åˆ°çš„ç½‘å€éƒ½æ˜¯ <code>/item/%xx%xx%xx...</code> è¿™æ ·çš„æ ¼å¼äº†. ä¹‹åæˆ‘ä»¬åœ¨è¿™äº›è¿‡æ»¤åçš„ç½‘é¡µä¸­éšæœºé€‰ä¸€ä¸ª, å½“åšä¸‹ä¸€ä¸ªè¦çˆ¬çš„ç½‘é¡µ. ä¸è¿‡æœ‰æ—¶å€™å¾ˆä¸å¹¸, åœ¨ <code>sub_urls</code> ä¸­å¹¶ä¸èƒ½æ‰¾åˆ°åˆé€‚çš„ç½‘é¡µ, æˆ‘ä»¬å°±å¾€å›è·³ä¸€ä¸ªç½‘é¡µ, å›åˆ°ä¹‹å‰çš„ç½‘é¡µä¸­å†éšæœºæŠ½ä¸€ä¸ªç½‘é¡µåšåŒæ ·çš„äº‹.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find valid urls</span></span><br><span class="line">sub_urls = soup.find_all(<span class="string">"a"</span>, {<span class="string">"target"</span>: <span class="string">"_blank"</span>, <span class="string">"href"</span>: re.compile(<span class="string">"/item/(%.{2})+$"</span>)})</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sub_urls) != <span class="number">0</span>:</span><br><span class="line">    his.append(random.sample(sub_urls, <span class="number">1</span>)[<span class="number">0</span>][<span class="string">'href'</span>])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># no valid sub link found</span></span><br><span class="line">    his.pop()</span><br><span class="line">print(his)</span><br></pre></td></tr></tbody></table></figure>

<p>æœ‰äº†è¿™å¥—ä½“ç³», æˆ‘ä»¬å°±èƒ½æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ª for loop ä¸­, è®©å®ƒåœ¨å„ç§ä¸åŒçš„ç½‘é¡µä¸­è·³æ¥è·³å»</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">his = [<span class="string">"/item/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/5162711"</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    url = base_url + his[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    html = urlopen(url).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    soup = BeautifulSoup(html, features=<span class="string">'lxml'</span>)</span><br><span class="line">    print(i, soup.find(<span class="string">'h1'</span>).get_text(), <span class="string">'    url: '</span>, his[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find valid urls</span></span><br><span class="line">    sub_urls = soup.find_all(<span class="string">"a"</span>, {<span class="string">"target"</span>: <span class="string">"_blank"</span>, <span class="string">"href"</span>: re.compile(<span class="string">"/item/(%.{2})+$"</span>)})</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sub_urls) != <span class="number">0</span>:</span><br><span class="line">        his.append(random.sample(sub_urls, <span class="number">1</span>)[<span class="number">0</span>][<span class="string">'href'</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># no valid sub link found</span></span><br><span class="line">        his.pop()</span><br></pre></td></tr></tbody></table></figure>



<h3 id="requests"><a href="#requests" class="headerlink" title="requests"></a>requests</h3><h4 id="è·å–ç½‘é¡µçš„æ–¹å¼"><a href="#è·å–ç½‘é¡µçš„æ–¹å¼" class="headerlink" title="è·å–ç½‘é¡µçš„æ–¹å¼"></a>è·å–ç½‘é¡µçš„æ–¹å¼</h4><p>å…¶å®åœ¨åŠ è½½ç½‘é¡µçš„æ—¶å€™, æœ‰å‡ ç§ç±»å‹, è€Œè¿™å‡ ç§ç±»å‹å°±æ˜¯ä½ æ‰“å¼€ç½‘é¡µçš„å…³é”®. æœ€é‡è¦çš„ç±»å‹ (method) å°±æ˜¯ <code>get</code> å’Œ <code>post</code> (å½“ç„¶è¿˜æœ‰<a href="https://www.w3schools.com/tags/ref_httpmethods.asp" target="_blank" rel="noopener">å…¶ä»–çš„</a>, æ¯”å¦‚ <code>head</code>, <code>delete</code>). åˆšæ¥è§¦ç½‘é¡µæ„æ¶çš„æœ‹å‹å¯èƒ½åˆä¼šè§‰å¾—æœ‰ç‚¹æ‡µé€¼äº†. è¿™äº›è¯·æ±‚çš„æ–¹å¼åˆ°åº•æœ‰ä»€ä¹ˆä¸åŒ? ä»–ä»¬åˆæœ‰ä»€ä¹ˆä½œç”¨?</p>
<p>æˆ‘ä»¬å°±æ¥è¯´ä¸¤ä¸ªé‡è¦çš„, <code>get</code>, <code>post</code>, 95% çš„æ—¶é—´, ä½ éƒ½æ˜¯åœ¨ä½¿ç”¨è¿™ä¸¤ä¸ªæ¥è¯·æ±‚ä¸€ä¸ªç½‘é¡µ.</p>
<ul>
<li>post<ul>
<li>è´¦å·ç™»å½•</li>
<li>æœç´¢å†…å®¹</li>
<li>ä¸Šä¼ å›¾ç‰‡</li>
<li>ä¸Šä¼ æ–‡ä»¶</li>
<li>å¾€æœåŠ¡å™¨ä¼ æ•°æ® ç­‰</li>
</ul>
</li>
<li>get<ul>
<li>æ­£å¸¸æ‰“å¼€ç½‘é¡µ</li>
<li><strong>ä¸</strong>å¾€æœåŠ¡å™¨ä¼ æ•°æ®</li>
</ul>
</li>
</ul>
<p>è¿™æ ·çœ‹æ¥, å¾ˆå¤šç½‘é¡µä½¿ç”¨ <code>get</code> å°±å¯ä»¥äº†, æ¯”å¦‚ ç™¾åº¦ç™¾ç§‘ é‡Œçš„æ‰€æœ‰é¡µé¢, éƒ½æ˜¯åªæ˜¯ <code>get</code> å‘é€è¯·æ±‚. è€Œ <code>post</code>, æˆ‘ä»¬åˆ™æ˜¯ç»™æœåŠ¡å™¨å‘é€ä¸ªæ€§åŒ–è¯·æ±‚, æ¯”å¦‚å°†ä½ çš„è´¦å·å¯†ç ä¼ ç»™æœåŠ¡å™¨, è®©å®ƒç»™ä½ è¿”å›ä¸€ä¸ªå«æœ‰ä½ ä¸ªäººä¿¡æ¯çš„ HTML.</p>
<p>ä»ä¸»åŠ¨å’Œè¢«åŠ¨çš„è§’åº¦æ¥è¯´, <code>post</code> ä¸­æ–‡æ˜¯<em>å‘é€</em>, æ¯”è¾ƒä¸»åŠ¨, ä½ <strong>æ§åˆ¶</strong>äº†æœåŠ¡å™¨è¿”å›çš„å†…å®¹. è€Œ <code>get</code> ä¸­æ–‡æ˜¯<em>å–å¾—</em>, æ˜¯è¢«åŠ¨çš„, ä½ <strong>æ²¡æœ‰</strong>å‘é€ç»™æœåŠ¡å™¨ä¸ªæ€§åŒ–çš„ä¿¡æ¯, å®ƒ<strong>ä¸ä¼š</strong>æ ¹æ®ä½ ä¸ªæ€§åŒ–çš„ä¿¡æ¯è¿”å›<strong>ä¸ä¸€æ ·</strong>çš„ HTML.</p>
<h4 id="requests-get-è¯·æ±‚"><a href="#requests-get-è¯·æ±‚" class="headerlink" title="requests get è¯·æ±‚"></a>requests get è¯·æ±‚</h4><p>æœ‰äº† requests, æˆ‘ä»¬å¯ä»¥å‘é€ä¸ªä¸­ method çš„è¯·æ±‚. æ¯”å¦‚ <code>get</code>. æˆ‘ä»¬æƒ³æ¨¡æ‹Ÿä¸€ä¸‹ç™¾åº¦çš„æœç´¢. é¦–å…ˆæˆ‘ä»¬éœ€è¦è§‚çœ‹ä¸€ä¸‹ç™¾åº¦æœç´¢çš„è§„å¾‹. åœ¨ç™¾åº¦æœç´¢æ¡†ä¸­å†™ä¸ŠCSDN æˆ‘ä»¬å‘ç°å®ƒå¼¹å‡ºäº†ä¸€ä¸²å¾ˆé•¿é•¿çš„ç½‘å€.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.baidu.com/s?word=CSDN&amp;tn=25017023_2_dg&amp;ch=5&amp;ie=utf-8</span><br></pre></td></tr></tbody></table></figure>



<p>ä½†æ˜¯ä»”ç»†ä¸€çœ‹, å’Œ CSDN æœ‰å…³çš„ä¿¡æ¯, åªæœ‰å‰é¢ä¸€å°æ®µ (&amp;word=CSDN), å…¶ä»–çš„å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯æ— ç”¨çš„ä¿¡æ¯. æ‰€ä»¥æˆ‘ä»¬ç°åœ¨æ¥å°è¯•ä¸€ä¸‹å¦‚æœçš„æ— ç”¨ url éƒ½å»æ‰ä¼šæ€æ ·? Duang! æˆ‘ä»¬è¿˜æ˜¯èƒ½æœåˆ° CSDN.</p>
<p>æ‰€ä»¥<code>&amp;word=CSDN</code> è¿™å°±æ˜¯æˆ‘ä»¬æœç´¢éœ€è¦çš„å…³é”®ä¿¡æ¯. æˆ‘ä»¬å°±èƒ½ç”¨ <code>get</code> æ¥æ­é…ä¸€äº›è‡ªå®šä¹‰çš„æœç´¢å…³é”®è¯æ¥ç”¨ python ä¸ªæ€§åŒ–æœç´¢. é¦–å…ˆ, æˆ‘ä»¬å›ºå®šä¸åŠ¨çš„ç½‘å€éƒ¨åˆ†æ˜¯ <a href="http://www.baidu.com/s" target="_blank" rel="noopener">http://www.baidu.com/s</a>, <code>?</code> åé¢çš„ä¸œè¥¿éƒ½æ˜¯ä¸€äº›å‚æ•° (parameters), æ‰€ä»¥æˆ‘ä»¬å°†è¿™äº› parameters ç”¨ python çš„å­—å…¸ä»£æ›¿, ç„¶åä¼ å…¥ requests.get() åŠŸèƒ½. ç„¶åæˆ‘ä»¬è¿˜èƒ½ç”¨ python (webbrowseræ¨¡å—) æ‰“å¼€ä¸€ä¸ªä½ çš„é»˜è®¤æµè§ˆå™¨, è§‚çœ‹ä½ æ˜¯å¦åœ¨ç™¾åº¦çš„æœç´¢é¡µé¢.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line">param = {<span class="string">"wd"</span>: <span class="string">"CSDN"</span>}  <span class="comment"># æœç´¢çš„ä¿¡æ¯</span></span><br><span class="line">r = requests.get(<span class="string">'http://www.baidu.com/s'</span>, params=param)</span><br><span class="line">print(r.url)</span><br><span class="line">webbrowser.open(r.url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://www.baidu.com/s?wd=%E8%8E%AB%E7%83%A6Python</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="requests-post-è¯·æ±‚"><a href="#requests-post-è¯·æ±‚" class="headerlink" title="requests post è¯·æ±‚"></a>requests post è¯·æ±‚</h4><p><code>post</code> åˆæ€ä¹ˆç”¨å‘¢? æˆ‘ä»¬ä¸¾ä¸ªå°ä¾‹å­, å‡è®¾ æˆ‘ä»¬æœ‰ä¸€ä¸ªæäº¤ä¿¡æ¯çš„çª—å£, å¦‚æœæˆ‘æäº¤ä¸Šå»è¿™ä¸ªä¿¡æ¯, é‚£è¾¹çš„æœåŠ¡å™¨ä¼šæ›´åŠ è¿™ä¸ªæäº¤çš„ä¿¡æ¯è¿”å›å‡ºå¦ä¸€ä¸ªç½‘é¡µ. è¿™å°±æ˜¯ç½‘é¡µæ€ä¹ˆæ ·ä½¿ç”¨ä½  <code>post</code> è¿‡å»çš„ä¿¡æ¯äº†.</p>
<p>æ¯”å¦‚æˆ‘åœ¨ä¸€ä¸ªè¡¨å•å¡«ä¸Šè‡ªå·±çš„å§“å, å½“æˆ‘ç‚¹ submit çš„æ—¶å€™, è¿™ä¸ªå§“å å°±ä¼šè¢«æäº¤ç»™æœåŠ¡å™¨, ç„¶åå®ƒä¼šæ ¹æ®æäº¤çš„å§“åè¿”å›è¿™ä¸ªç½‘é¡µ.</p>
<p>è¿™æ ·å’‹çœ‹èµ·æ¥å¥½åƒå’Œä¸Šé¢è®²çš„ <code>get</code> ç™¾åº¦æœç´¢æ²¡åŒºåˆ«å‘€? éƒ½æ˜¯æäº¤ä¸€äº›ä¿¡æ¯, è¿”å›ä¸€ä¸ªç•Œé¢. ä½†æ˜¯, <strong>é‡ç‚¹æ¥äº†</strong>. ä½ çœ‹çœ‹ç½‘å€æ . ä½  <code>post</code> ä¸Šå»çš„ä¸ªäººä¿¡æ¯, æœ‰æ²¡æœ‰æ˜¾ç¤ºåœ¨ url é‡Œ? ä½ æ„¿æ„å°†ä½ çš„ç§å¯†ä¿¡æ¯æ˜¾ç¤ºåœ¨ url é‡Œå—? ä½  <code>post</code> è¿‡å»çš„ä¿¡æ¯æ˜¯äº¤ç»™æœåŠ¡å™¨å†…éƒ¨å¤„ç†çš„. ä¸æ˜¯ç”¨æ¥æ˜¾ç¤ºåœ¨ç½‘å€ä¸Šçš„.</p>
<p>æ‡‚äº†è¿™äº›, æˆ‘ä»¬å°±æ¥çœ‹ä½¿ç”¨ python å’Œ requests æ€ä¹ˆåš <code>post</code> è¿™ä¸ªæ“ä½œå§.</p>
<p>é¦–å…ˆæˆ‘ä»¬è°ƒå‡ºæµè§ˆå™¨çš„ <code>inspect</code> ç„¶åå‘ç°æˆ‘ä»¬å¡«å…¥å§“åçš„åœ°æ–¹åŸæ¥æ˜¯åœ¨ä¸€ä¸ª <code>&lt;form&gt;</code> é‡Œé¢.</p>
<p>è¿™ä¸ª <code>&lt;form&gt;</code> é‡Œé¢æœ‰ä¸€äº› <code>&lt;input&gt;</code> ä¸ª tag, æˆ‘ä»¬ä»”ç»†çœ‹åˆ° <code>&lt;input&gt;</code> é‡Œé¢çš„è¿™ä¸ªå€¼ <code>name="firstname"</code> å’Œ <code>name="lastname"</code>, è¿™ä¸¤ä¸ªå°±æ˜¯æˆ‘ä»¬è¦ <code>post</code> æäº¤ä¸Šå»çš„å…³é”®ä¿¡æ¯äº†. æˆ‘ä»¬å¡«å¥½å§“å, ä¸ºäº†è®°å½•ç‚¹å‡» submit å, æµè§ˆå™¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆç¿»å¤©è¦†åœ°çš„å˜åŒ–, æˆ‘ä»¬åœ¨ <code>inspect</code> çª—å£, é€‰æ‹© <code>Network</code>, å‹¾é€‰ <code>Preserve log</code>, å†ç‚¹å‡» submit, ä½ å°±èƒ½çœ‹åˆ°æœåŠ¡å™¨è¿”å›ç»™ä½ å®šåˆ¶åŒ–åçš„é¡µé¢æ—¶, ä½ ä½¿ç”¨çš„æ–¹æ³•å’Œæ•°æ®.</p>
<p>è¿™äº›æ•°æ®åŒ…æ‹¬äº†:</p>
<ul>
<li>Request URL (post è¦ç”¨çš„ URL)</li>
<li>Request Method (post)</li>
<li>Form Data (post å»çš„ä¿¡æ¯)</li>
</ul>
<p>æœ‰äº†è¿™äº›è®°å½•, æˆ‘ä»¬å°±èƒ½å¼€å§‹å†™ Python æ¥æ¨¡æ‹Ÿè¿™ä¸€æ¬¡æäº¤ post äº†. </p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = {<span class="string">'firstname'</span>: <span class="string">'xx'</span>, <span class="string">'lastname'</span>: <span class="string">'xx'</span>}</span><br><span class="line">r = requests.post(<span class="string">'url'</span>, data=data)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ä¸Šä¼ å›¾ç‰‡"><a href="#ä¸Šä¼ å›¾ç‰‡" class="headerlink" title="ä¸Šä¼ å›¾ç‰‡"></a>ä¸Šä¼ å›¾ç‰‡</h4><p>ä¼ ç…§ç‰‡ä¹Ÿæ˜¯ <code>post</code> çš„ä¸€ç§, æˆ‘ä»¬å¾—å°†æœ¬åœ°çš„ç…§ç‰‡æ–‡ä»¶ä¼ é€åˆ°æœåŠ¡å™¨. æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ª<a href="http://pythonscraping.com/files/form2.html" target="_blank" rel="noopener">ç½‘é¡µ</a>æ¥æ¨¡æ‹Ÿä¸€æ¬¡ä¼ ç…§ç‰‡çš„è¿‡ç¨‹</p>
<p>å¦‚æœä½ ç•™æ„è§‚å¯Ÿ url, ä½ ä¼šå‘ç°, ä¼ é€å®Œç…§ç‰‡ä»¥åçš„ url æœ‰å˜åŠ¨. æˆ‘ä»¬ä½¿ç”¨åŒæ ·çš„æ­¥éª¤å†æ¬¡æ£€æŸ¥, å‘ç°, choose file æŒ‰é”®é“¾æ¥çš„ <code>&lt;input&gt;</code> æ˜¯ä¸€ä¸ªå« <code>uploadFile</code> çš„åå­—. æˆ‘ä»¬å°†è¿™ä¸ªåå­—è®°ä¸‹, æ”¾å…¥ python çš„å­—å…¸å½“ä¸€ä¸ª key.</p>
<p>æ¥ç€åœ¨å­—å…¸ä¸­, ä½¿ç”¨ open æ‰“å¼€ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶, å½“åšè¦ä¸Šä¼ çš„æ–‡ä»¶. æŠŠè¿™ä¸ªå­—å…¸æ”¾å…¥ä½ çš„ <code>post</code> é‡Œé¢çš„ <code>files</code> å‚æ•°. å°±èƒ½ä¸Šä¼ ä½ çš„å›¾ç‰‡äº†, ç½‘é¡µä¼šè¿”å›ä¸€ä¸ªé¡µé¢, å°†ä½ çš„å›¾ç‰‡åæ˜¾ç¤ºåœ¨ä¸Šé¢.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file = {<span class="string">'uploadFile'</span>: open(<span class="string">'./image.png'</span>, <span class="string">'rb'</span>)}</span><br><span class="line">r = requests.post(<span class="string">'url'</span>, files=file)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h4><p>ç”¨ <code>post</code> è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„, å°±æ˜¯æ¨¡æ‹Ÿç™»å½•. å†ç™»å½•çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…å‘¢? </p>
<p>æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹, ç™»å½•è´¦å·, æˆ‘ä»¬çš„æµè§ˆå™¨åšäº†ä»€ä¹ˆ.</p>
<ol>
<li>ä½¿ç”¨ post æ–¹æ³•ç™»å½•äº†ç¬¬ä¸€ä¸ªçº¢æ¡†çš„ url</li>
<li>post çš„æ—¶å€™, ä½¿ç”¨äº† Form data ä¸­çš„ç”¨æˆ·åå’Œå¯†ç </li>
<li><strong>ç”Ÿæˆäº†ä¸€äº› cookies</strong></li>
</ol>
<p>ç¬¬ä¸‰ç‚¹æˆ‘ä»¬æ˜¯ä»æ¥æ²¡æœ‰æåˆ°è¿‡çš„. cookie, å¬èµ·æ¥å¾ˆç†Ÿå‘€! æ¯å½“æ¸¸è§ˆå™¨å‡ºç°é—®é¢˜çš„æ—¶å€™, ç½‘ä¸Šçš„è§£å†³æ–¹æ³•æ˜¯ä¸æ˜¯éƒ½æœ‰ä»€ä¹ˆæ¸…é™¤ cookie ä¹‹ç±»çš„, é‚£ cookie å®é™…ä¸Šæ˜¯ä»€ä¹ˆå‘¢? <a href="https://baike.baidu.com/item/cookie/1119?fr=aladdin" target="_blank" rel="noopener">è¿™é‡Œ</a>ç»™å‡ºäº†å’Œå…¨é¢çš„ä»‹ç».</p>
<p>ç®€å•æ¥è¯´, å› ä¸ºæ‰“å¼€ç½‘é¡µæ—¶, æ¯ä¸€ä¸ªé¡µé¢éƒ½æ˜¯ä¸è¿ç»­çš„, æ²¡æœ‰å…³è”çš„, cookies å°±æ˜¯ç”¨æ¥è¡”æ¥ä¸€ä¸ªé¡µé¢å’Œå¦ä¸€ä¸ªé¡µé¢çš„å…³ç³». æ¯”å¦‚è¯´å½“æˆ‘ç™»å½•ä»¥å, æµè§ˆå™¨ä¸ºäº†ä¿å­˜æˆ‘çš„ç™»å½•ä¿¡æ¯, å°†è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨äº† cookie ä¸­. ç„¶åæˆ‘è®¿é—®ç¬¬äºŒä¸ªé¡µé¢çš„æ—¶å€™, ä¿å­˜çš„ cookie è¢«è°ƒç”¨, æœåŠ¡å™¨çŸ¥é“æˆ‘ä¹‹å‰åšäº†ä»€ä¹ˆ, æµè§ˆäº†äº›ä»€ä¹ˆ. åƒä½ åœ¨ç½‘ä¸Šçœ‹åˆ°çš„å¹¿å‘Š, ä¸ºä»€ä¹ˆéƒ½å¯èƒ½æ˜¯ä½ æ„Ÿå…´è¶£çš„å•†å“? ä½ ç™»å½•æ·˜å®, ç»™ä½ æ¨èçš„ä¸ºä»€ä¹ˆéƒ½å’Œä½ ä¹°è¿‡çš„ç±»ä¼¼? éƒ½æ˜¯ cookies çš„åŠŸåŠ³, è®©æœåŠ¡å™¨çŸ¥é“ä½ çš„ä¸ªæ€§åŒ–éœ€æ±‚.</p>
<p>æ‰€ä»¥å¤§éƒ¨åˆ†æ—¶å€™, æ¯æ¬¡ä½ ç™»å½•, ä½ å°±ä¼šæœ‰ä¸€ä¸ª cookies, é‡Œé¢ä¼šæåˆ°ä½ å·²ç»æ˜¯ç™»å½•çŠ¶æ€äº†. æ‰€ä»¥ cookie åœ¨è¿™æ—¶å€™å¾ˆé‡è¦. cookies çš„ä¼ é€’ä¹Ÿç‰¹åˆ«é‡è¦, æ¯”å¦‚æˆ‘ç”¨ <code>requests.post</code> + <code>payload</code> çš„ç”¨æˆ·ä¿¡æ¯å‘ç»™ç½‘é¡µ, è¿”å›çš„ <code>r</code> é‡Œé¢ä¼šæœ‰ç”Ÿæˆçš„ cookies ä¿¡æ¯. æ¥ç€æˆ‘è¯·æ±‚å»ç™»å½•åçš„é¡µé¢æ—¶, ä½¿ç”¨ <code>request.get</code>, å¹¶å°†ä¹‹å‰çš„ cookies ä¼ å…¥åˆ° get è¯·æ±‚. è¿™æ ·å°±èƒ½å·²ç™»å½•çš„åä¹‰è®¿é—® get çš„é¡µé¢äº†.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">payload = {<span class="string">'username'</span>: <span class="string">'Morvan'</span>, <span class="string">'password'</span>: <span class="string">'password'</span>}</span><br><span class="line">r = requests.post(<span class="string">'/pages/cookies/welcome.php'</span>, data=payload)</span><br><span class="line">print(r.cookies.get_dict())</span><br><span class="line"></span><br><span class="line"><span class="comment"># {'username': 'Morvan', 'loggedin': '1'}</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">'/pages/cookies/profile.php'</span>, cookies=r.cookies)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hey Morvan! Looks like you're still logged into the site!</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="ä½¿ç”¨-Session-ç™»å½•"><a href="#ä½¿ç”¨-Session-ç™»å½•" class="headerlink" title="ä½¿ç”¨ Session ç™»å½•"></a>ä½¿ç”¨ Session ç™»å½•</h4><p>ä¸è¿‡æ¯æ¬¡éƒ½è¦ä¼ é€’ cookies æ˜¯å¾ˆéº»çƒ¦çš„, å¥½åœ¨ requests æœ‰ä¸ªå¾ˆ handy çš„åŠŸèƒ½, é‚£å°±æ˜¯ Session. åœ¨ä¸€æ¬¡ä¼šè¯ä¸­, æˆ‘ä»¬çš„ cookies ä¿¡æ¯éƒ½æ˜¯ç›¸è¿é€šçš„, å®ƒè‡ªåŠ¨å¸®æˆ‘ä»¬ä¼ é€’è¿™äº› cookies ä¿¡æ¯.</p>
<p>åŒæ ·æ˜¯æ‰§è¡Œä¸Šé¢çš„ç™»å½•æ“ä½œ, ä¸‹é¢å°±æ˜¯ä½¿ç”¨ session çš„ç‰ˆæœ¬. åˆ›å»ºå®Œä¸€ä¸ª session è¿‡å, æˆ‘ä»¬ç›´æ¥åªç”¨ session æ¥ <code>post</code> å’Œ <code>get</code>. è€Œä¸”è¿™æ¬¡ <code>get</code> çš„æ—¶å€™, æˆ‘ä»¬å¹¶æ²¡æœ‰ä¼ å…¥ cookies. ä½†æ˜¯å®é™…ä¸Š session å†…éƒ¨å°±å·²ç»æœ‰äº†ä¹‹å‰çš„ cookies äº†.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">session = requests.Session()</span><br><span class="line">payload = {<span class="string">'username'</span>: <span class="string">'Morvan'</span>, <span class="string">'password'</span>: <span class="string">'password'</span>}</span><br><span class="line">r = session.post(<span class="string">'/pages/cookies/welcome.php'</span>, data=payload)</span><br><span class="line">print(r.cookies.get_dict())</span><br><span class="line"></span><br><span class="line"><span class="comment"># {'username': 'Morvan', 'loggedin': '1'}</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = session.get(<span class="string">"http://pythonscraping.com/pages/cookies/profile.php"</span>)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hey Morvan! Looks like you're still logged into the site!</span></span><br></pre></td></tr></tbody></table></figure>

<p>è¿™å°±æ˜¯æˆ‘ä»¬è¿™æ¬¡çš„æ•™å­¦, æƒ³äº†è§£æ›´å¤š requests ä½¿ç”¨çš„æœ‹å‹çœ‹åˆ°<a href="http://docs.python-requests.org/en/master/" target="_blank" rel="noopener">è¿™é‡Œ</a>.</p>
<h3 id="ä¸‹è½½æ–‡ä»¶"><a href="#ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ–‡ä»¶"></a>ä¸‹è½½æ–‡ä»¶</h3><h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>åœ¨ä¸‹è½½ä¹‹å‰, æˆ‘ä»¬çš„å¼„æ¸…æ¥šæ€ä¹ˆæ ·ä¸‹è½½. æƒ³ä¸‹ä¸€å¼ å›¾, æˆ‘ä»¬é¦–å…ˆè¦åˆ°è¿™å¼ å›¾æ‰€åœ¨çš„ç½‘é¡µ. åœ¨è¿™ä¸ªç½‘é¡µä¸­æ‰¾åˆ°è¿™å¼ å›¾çš„ä½ç½®, å¹¶å³é”® <code>inspect</code>, æ‰¾åˆ°å®ƒåœ¨ HTML ä¸­çš„ä¿¡æ¯.</p>
<p>å‘ç°åŸå›¾è¢«å­˜æ”¾åœ¨è¿™ä¸ªç½‘é¡µ, æ³¨æ„è¿™ä¸ªåœ°å€å¼€å¤´æ˜¯ <code>/</code>, å¹¶ä¸æ˜¯å®Œæ•´çš„ç½‘å€, è¿™ç§å½¢å¼ä»£è¡¨ç€, å®ƒæ˜¯åœ¨ä¸»åŸŸåä¸‹é¢çš„ç½‘å€. æ‰€ä»¥æˆ‘ä»¬è¿˜è¦å°†å…¶è¡¥å…¨, æ‰èƒ½åœ¨ç½‘å€æ ä¸­æ‰¾åˆ°è¿™ä¸ªå›¾ç‰‡åœ°å€.</p>
<p>æ‰¾åˆ°äº†è¿™ä¸ªç½‘å€, æˆ‘ä»¬å°±èƒ½å¼€å§‹ä¸‹è½½äº†. ä¸ºäº†ä¸‹è½½åˆ°ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶å¤¹, æˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹å§. å¹¶ä¸”è§„å®šè¿™ä¸ªå›¾ç‰‡ä¸‹è½½åœ°å€.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.makedirs(<span class="string">'./img/'</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">IMAGE_URL = <span class="string">"url"</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="ä½¿ç”¨-urlretrieve"><a href="#ä½¿ç”¨-urlretrieve" class="headerlink" title="ä½¿ç”¨ urlretrieve"></a>ä½¿ç”¨ urlretrieve</h4><p>åœ¨ urllib æ¨¡å—ä¸­, æä¾›äº†æˆ‘ä»¬ä¸€ä¸ªä¸‹è½½åŠŸèƒ½ urlretrieve. ä½¿ç”¨èµ·æ¥å¾ˆç®€å•. è¾“å…¥ä¸‹è½½åœ°å€ <code>IMAGE_URL</code> å’Œè¦å­˜æ”¾çš„ä½ç½®. å›¾ç‰‡å°±ä¼šè¢«è‡ªåŠ¨ä¸‹è½½è¿‡å»äº†.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlretrieve</span><br><span class="line">urlretrieve(IMAGE_URL, <span class="string">'./img/image1.png'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ä½¿ç”¨-request"><a href="#ä½¿ç”¨-request" class="headerlink" title="ä½¿ç”¨ request"></a>ä½¿ç”¨ request</h4><p>è€Œåœ¨ requestsæ¨¡å—, ä¹Ÿèƒ½æ‹¿æ¥ä¸‹ä¸œè¥¿. ä¸‹é¢çš„ä»£ç å®ç°äº†å’Œä¸Šé¢ä¸€æ ·çš„åŠŸèƒ½, ä½†æ˜¯ç¨å¾®é•¿äº†ç‚¹. ä½†æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æåˆ° requests çš„ä¸‹è½½å‘¢? å› ä¸ºä½¿ç”¨å®ƒçš„å¦ä¸€ç§æ–¹æ³•, æˆ‘ä»¬å¯ä»¥æ›´åŠ æœ‰æ•ˆç‡çš„ä¸‹è½½å¤§æ–‡ä»¶.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r = requests.get(IMAGE_URL)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./img/image2.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(r.content)</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰€ä»¥è¯´, å¦‚æœä½ è¦ä¸‹è½½çš„æ˜¯å¤§æ–‡ä»¶, æ¯”å¦‚è§†é¢‘ç­‰. requests èƒ½è®©ä½ ä¸‹ä¸€ç‚¹, ä¿å­˜ä¸€ç‚¹, è€Œä¸æ˜¯è¦å…¨éƒ¨ä¸‹è½½å®Œæ‰èƒ½ä¿å­˜å»å¦å¤–çš„åœ°æ–¹. è¿™å°±æ˜¯ä¸€ä¸ª chunk ä¸€ä¸ª chunk çš„ä¸‹è½½. ä½¿ç”¨ <code>r.iter_content(chunk_size)</code> æ¥æ§åˆ¶æ¯ä¸ª chunk çš„å¤§å°, ç„¶ååœ¨æ–‡ä»¶ä¸­å†™å…¥è¿™ä¸ª chunk å¤§å°çš„æ•°æ®.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(IMAGE_URL, stream=<span class="literal">True</span>)    <span class="comment"># stream loading</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./img/image3.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">32</span>):</span><br><span class="line">        f.write(chunk)</span><br></pre></td></tr></tbody></table></figure>

<p>æœ‰äº†è¿™äº›çŸ¥è¯†çš„ç§¯ç´¯, æˆ‘ä»¬å°±èƒ½å¼€å§‹åšä¸€ä¸ªå°çš„å®æˆ˜ç»ƒä¹ </p>
<h3 id="ä¸‹è½½ç¾å›½åœ°å›¾"><a href="#ä¸‹è½½ç¾å›½åœ°å›¾" class="headerlink" title="ä¸‹è½½ç¾å›½åœ°å›¾"></a>ä¸‹è½½ç¾å›½åœ°å›¾</h3><h4 id="æ‰¾åˆ°å›¾ç‰‡ä½ç½®"><a href="#æ‰¾åˆ°å›¾ç‰‡ä½ç½®" class="headerlink" title="æ‰¾åˆ°å›¾ç‰‡ä½ç½®"></a>æ‰¾åˆ°å›¾ç‰‡ä½ç½®</h4><p>è¯´ç™½äº†, æ¯æ¬¡çš„çˆ¬è™«, éƒ½æ˜¯å…ˆåˆ†æä¸€ä¸‹è¿™ä¸ªç½‘é¡µè¦æ‰¾çš„ä¸œè¥¿çš„ä½ç½®, ç„¶åæ€ä¹ˆç´¢å¼•ä¸Šè¿™ä¸ªä½ç½®, æœ€åç”¨ python æ‰¾åˆ°å®ƒ. è¿™æ¬¡ä¹Ÿæ˜¯è¿™ä¸ªé€»è¾‘. æˆ‘ä»¬çœ‹çœ‹ä»Šå¤©è¦çˆ¬çš„è¿™ä¸ªå›¾ç‰‡<a href="https://i.natgeofe.com/n/fb700cc3-3cdb-48cc-a2bd-1ba9ed6a2c72/NGM-10439-1080x805.jpg?w=960" target="_blank" rel="noopener">ç½‘å€</a>. å®šä½åˆ°æœ€æ–°å›¾ç‰‡çš„ä½ç½®,</p>
<p>æ‰¾åˆ°è¿™å¼ å›¾ç‰‡çš„æ‰€åœ¨ä½ç½®, å¯¹æ¯”è¿™ç±»å‹çš„å›¾ç‰‡, æ‰¾åˆ°ä¸€ç§æ‰‹æ®µæ¥ç­›é€‰è¿™äº›å›¾ç‰‡. è€Œå›¾ç‰‡åœ°å€éƒ½æ˜¯åœ¨ <code>&lt;img&gt;</code> ä¸­.ç°åœ¨æˆ‘ä»¬æœ‰äº†æ€è·¯, å…ˆæ‰¾å¸¦æœ‰ <code>Image__Wrapper Image__Wrapper--relative</code> çš„è¿™ç§ <code>&lt;div&gt;</code>, ç„¶ååœ¨ <code>&lt;div&gt;</code> é‡Œé¢æ‰¾ <code>&lt;img&gt;</code>.</p>
<h4 id="ä¸‹è½½å›¾ç‰‡"><a href="#ä¸‹è½½å›¾ç‰‡" class="headerlink" title="ä¸‹è½½å›¾ç‰‡"></a>ä¸‹è½½å›¾ç‰‡</h4><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">URL = <span class="string">"https://www.nationalgeographic.com/travel/article/ethical-souvenirs-crafts-shop-australia-india/"</span></span><br></pre></td></tr></tbody></table></figure>

<p>ç”¨ BeautifulSoup æ‰¾åˆ°å¸¦æœ‰ <code>Image__Wrapper Image__Wrapper--relative</code> çš„è¿™ç§ <code>&lt;div&gt;</code>,</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">html = requests.get(URL).text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'lxml'</span>)</span><br><span class="line">img_ul = soup.find_all(<span class="string">'div'</span>, {<span class="string">"class"</span>: <span class="string">"Image__Wrapper Image__Wrapper--relative"</span>})</span><br></pre></td></tr></tbody></table></figure>

<p>ä» divä¸­æ‰¾åˆ°æ‰€æœ‰çš„ <code>&lt;img&gt;</code>, ç„¶åæå– <code>&lt;img&gt;</code> çš„ <code>src</code> å±æ€§, é‡Œé¢çš„å°±æ˜¯å›¾ç‰‡çš„ç½‘å€å•¦. æ¥ç€, å°±ç”¨ä¹‹å‰åœ¨ requests ä¸‹è½½é‡Œæåˆ°çš„ä¸€æ®µæ®µä¸‹è½½.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ul <span class="keyword">in</span> img_ul:</span><br><span class="line">    imgs = ul.find_all(<span class="string">'img'</span>)</span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> imgs:</span><br><span class="line">        url = img[<span class="string">'src'</span>]</span><br><span class="line">        r = requests.get(url, stream=<span class="literal">True</span>)</span><br><span class="line">        image_name = url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'./img/%s'</span> % image_name, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">128</span>):</span><br><span class="line">                f.write(chunk)</span><br><span class="line">        print(<span class="string">'Saved %s'</span> % image_name)</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœä½ åªæ˜¯å¶å°”çˆ¬ä¸€çˆ¬ç½‘é¡µ, å­¦åˆ°ç›®å‰ä¸ºæ­¢, ä½ å·²ç»å…¥é—¨äº†, ä½†æ˜¯å¦‚æœä½ æƒ³è¦ç»§ç»­æ·±å…¥, ä½ å¼€å§‹å¯¹çˆ¬è™«çš„æ•ˆç‡æ‹…å¿§, è§‰å¾—è‡ªå·±çˆ¬å¾—å¤ªæ…¢, æƒ³è¦å¤§è§„æ¨¡çˆ¬å–ç½‘é¡µ, é‚£ä¹ˆæ¥ä¸‹æ¥çš„å†…å®¹å°±å†é€‚åˆä½ ä¸è¿‡äº†. æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¼šæåˆ°çˆ¬è™«çš„ææ•ˆæ–¹æ³•. è€Œä¸”ç°åœ¨æˆ‘ä»¬çˆ¬å–çš„éƒ½æ˜¯é™æ€ç½‘é¡µ , å¦‚æœä½ é‡åˆ° JavaScript å¾ˆå¤šçš„åŠ¨æ€åŠ è½½ç½‘é¡µ (æ·˜å®ç­‰), å°±éœ€è¦selenium .</p>
<h3 id="åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼"><a href="#åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼" class="headerlink" title="åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼"></a>åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼</h3><h4 id="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«"><a href="#ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«" class="headerlink" title="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«"></a>ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«</h4><p>åˆ†å¸ƒå¼çˆ¬è™«ä¸»è¦æ˜¯ä¸ºäº†éå¸¸æœ‰æ•ˆç‡çš„æŠ“å–ç½‘é¡µ, æˆ‘ä»¬çš„ç¨‹åºä¸€èˆ¬æ˜¯å•çº¿ç¨‹è·‘çš„, æŒ‡ä»¤ä¹Ÿæ˜¯ä¸€æ¡æ¡å¤„ç†çš„, æ¯æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤æ‰èƒ½è·³åˆ°ä¸‹ä¸€æ¡. é‚£ä¹ˆåœ¨çˆ¬è™«çš„ä¸–ç•Œé‡Œ, è¿™é‡Œå­˜åœ¨ç€ä¸€ä¸ªé—®é¢˜.</p>
<p>å¦‚æœä½ å·²ç»é¡ºåˆ©åœ°æ‰§è¡Œè¿‡äº†å‰å‡ èŠ‚çš„çˆ¬è™«ä»£ç , ä½ ä¼šå‘ç°, æœ‰æ—¶å€™ä»£ç è¿è¡Œçš„æ—¶é—´å¤§éƒ¨åˆ†éƒ½èŠ±åœ¨äº†ä¸‹è½½ç½‘é¡µä¸Š. æœ‰æ—¶å€™ä¸åˆ°ä¸€ç§’èƒ½ä¸‹è½½å¥½ä¸€å¼ ç½‘é¡µçš„ HTML, æœ‰æ—¶å€™å´è¦å‡ åç§’. è€Œä¸”éè¦ç­‰åˆ° HTML ä¸‹è½½å¥½äº†ä»¥å, æ‰èƒ½æ‰§è¡Œç½‘é¡µåˆ†æç­‰æ­¥éª¤. è¿™éå¸¸æµªè´¹æ—¶é—´.</p>
<p>å¦‚æœæˆ‘ä»¬èƒ½åˆç†åˆ©ç”¨è®¡ç®—èµ„æº, åœ¨ä¸‹è½½ä¸€éƒ¨åˆ†ç½‘é¡µçš„æ—¶å€™å°±å·²ç»å¼€å§‹åˆ†æå¦ä¸€éƒ¨åˆ†ç½‘é¡µäº†. è¿™å°†ä¼šå¤§å¤§èŠ‚çœæ•´ä¸ªç¨‹åºçš„è¿è¡Œæ—¶é—´. åˆæˆ–è€…, æˆ‘ä»¬èƒ½åŒæ—¶ä¸‹è½½å¤šä¸ªç½‘é¡µ, åŒæ—¶åˆ†æå¤šä¸ªç½‘é¡µ, è¿™æ ·å°±æœ‰ç§äº‹å€åŠŸåŠçš„æ•ˆç”¨. åˆ†å¸ƒå¼çˆ¬è™«çš„ä½“ç³»æœ‰å¾ˆå¤šç§, å¤„ç†ä¼˜åŒ–çš„é—®é¢˜ä¹Ÿæ˜¯å¤šæ ·çš„. è¿™é‡Œæœ‰<a href="http://bittiger.blogspot.com.au/2016/02/blog-post_3.html" target="_blank" rel="noopener">ä¸€ç¯‡åšå®¢</a>å¯ä»¥å½“åšæ‰©å±•é˜…è¯», æ¥äº†è§£å½“ä»Šæ¯”è¾ƒæµè¡Œçš„åˆ†å¸ƒå¼çˆ¬è™«æ¡†æ¶.</p>
<h4 id="æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«"><a href="#æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«" class="headerlink" title="æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«"></a>æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«</h4><p>è€Œä»Šå¤©æˆ‘ä»¬æƒ³æ­å»ºçš„è¿™ä¸€ä¸ªçˆ¬è™«, å°±æ˜¯åŒæ—¶ä¸‹è½½, åŒæ—¶åˆ†æçš„è¿™ä¸€ç§ç±»å‹çš„åˆ†å¸ƒå¼çˆ¬è™«. è™½ç„¶ç®—ä¸ä¸Šç‰¹åˆ«ä¼˜åŒ–çš„æ¡†æ¶, ä½†æ˜¯æ¦‚å¿µç†è§£èµ·æ¥æ¯”è¾ƒå®¹æ˜“. æˆ‘æœ‰å°è¯•è¿‡å¾’æ‰‹å†™é«˜çº§ä¸€ç‚¹çš„åˆ†å¸ƒå¼çˆ¬è™«, ä½†æ˜¯å†™èµ·æ¥éå¸¸éº»çƒ¦. æˆ‘ç¢ç£¨äº†ä¸€ä¸‹, æ‰“ç®—ç»™å¤§å®¶ä»‹ç»çš„è¿™ç§åˆ†å¸ƒå¼çˆ¬è™«ä»£ç ä¹Ÿè¾ƒå¥½å†™, è€Œä¸”æ•ˆç‡æ¯”æ™®é€šçˆ¬è™«å¿«äº†3.5å€. </p>
<p>ä¸»è¦æ¥è¯´, æˆ‘ä»¬æœ€å¼€å§‹æœ‰ä¸€ä¸ªç½‘é¡µ, ç„¶åé¦–é¡µä¸­æœ‰å¾ˆå¤š url, æˆ‘ä»¬ä½¿ç”¨å¤šè¿›ç¨‹ åŒæ—¶å¼€å§‹ä¸‹è½½è¿™äº› url, å¾—åˆ°è¿™äº› url çš„ HTML ä»¥å, åŒæ—¶å¼€å§‹è§£æ (æ¯”å¦‚ BeautifulSoup) ç½‘é¡µå†…å®¹. åœ¨ç½‘é¡µä¸­å¯»æ‰¾è¿™ä¸ªç½‘ç«™è¿˜æ²¡æœ‰çˆ¬è¿‡çš„é“¾æ¥. æœ€ç»ˆçˆ¬å®Œæ•´ä¸ª ç½‘ç«™æ‰€æœ‰é¡µé¢.</p>
<p>æœ‰äº†è¿™ç§æ€è·¯, æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†. ä½ å¯ä»¥åœ¨<a href="https://github.com/MorvanZhou/easy-scraping-tutorial/blob/master/notebook/4-1-distributed-scraping.ipynb" target="_blank" rel="noopener">æˆ‘çš„ Github</a> ä¸€æ¬¡æ€§è§‚çœ‹å…¨éƒ¨ä»£ç .</p>
<p>é¦–å…ˆ import å…¨éƒ¨è¦ç”¨çš„æ¨¡å—, å¹¶è§„å®šä¸€ä¸ªä¸»é¡µ. </p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen, urljoin</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># base_url = "http://127.0.0.1:4000/"</span></span><br><span class="line">base_url = <span class="string">'https://xxx.com/'</span></span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªåŠŸèƒ½, ä¸€ä¸ªæ˜¯ç”¨æ¥çˆ¬å–ç½‘é¡µçš„(crawl), ä¸€ä¸ªæ˜¯è§£æç½‘é¡µçš„(parse). æœ‰äº†å‰å‡ èŠ‚å†…å®¹çš„é“ºå«, ä½ åº”è¯¥èƒ½ä¸€è¨€çœ‹æ‡‚ä¸‹é¢çš„ä»£ç . <code>crawl()</code> ç”¨ urlopen æ¥æ‰“å¼€ç½‘é¡µ, æˆ‘ç”¨çš„å†…ç½‘æµ‹è¯•, æ‰€ä»¥ä¸ºäº†ä½“ç°ä¸‹è½½ç½‘é¡µçš„å»¶è¿Ÿ, æ·»åŠ äº†ä¸€ä¸ª <code>time.sleep(0.1)</code> çš„ä¸‹è½½å»¶è¿Ÿ. è¿”å›åŸå§‹çš„ HTML é¡µé¢, <code>parse()</code> å°±æ˜¯åœ¨è¿™ä¸ª HTML é¡µé¢ä¸­æ‰¾åˆ°éœ€è¦çš„ä¿¡æ¯, æˆ‘ä»¬ç”¨ BeautifulSoup è¿”å›æ‰¾åˆ°çš„ä¿¡æ¯.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crawl</span><span class="params">(url)</span>:</span></span><br><span class="line">    response = urlopen(url)</span><br><span class="line">    <span class="comment"># time.sleep(0.1)             # slightly delay for downloading</span></span><br><span class="line">    <span class="keyword">return</span> response.read().decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(html)</span>:</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">'lxml'</span>)</span><br><span class="line">    urls = soup.find_all(<span class="string">'a'</span>, {<span class="string">"href"</span>: re.compile(<span class="string">'^/.+?/$'</span>)})</span><br><span class="line">    title = soup.find(<span class="string">'h1'</span>).get_text().strip()</span><br><span class="line">    page_urls = set([urljoin(base_url, url[<span class="string">'href'</span>]) <span class="keyword">for</span> url <span class="keyword">in</span> urls])   <span class="comment"># å»é‡</span></span><br><span class="line">    url = soup.find(<span class="string">'meta'</span>, {<span class="string">'property'</span>: <span class="string">"og:url"</span>})[<span class="string">'content'</span>]</span><br><span class="line">    <span class="keyword">return</span> title, page_urls, url</span><br></pre></td></tr></tbody></table></figure>



<p>ç½‘é¡µä¸­çˆ¬å–ä¸­, è‚¯å®šä¼šçˆ¬åˆ°é‡å¤çš„ç½‘å€, ä¸ºäº†å»é™¤æ‰è¿™äº›é‡å¤, æˆ‘ä»¬ä½¿ç”¨ python çš„ set åŠŸèƒ½. å®šä¹‰ä¸¤ä¸ª set, ç”¨æ¥æœé›†çˆ¬è¿‡çš„ç½‘é¡µå’Œæ²¡çˆ¬è¿‡çš„.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unseen = set([base_url,])</span><br><span class="line">seen = set()</span><br></pre></td></tr></tbody></table></figure>

<h4 id="æµ‹è¯•æ™®é€šçˆ¬æ³•"><a href="#æµ‹è¯•æ™®é€šçˆ¬æ³•" class="headerlink" title="æµ‹è¯•æ™®é€šçˆ¬æ³•"></a>æµ‹è¯•æ™®é€šçˆ¬æ³•</h4><p>ä¸ºäº†å¯¹æ¯”æ•ˆæœ, æˆ‘ä»¬å°†åœ¨ä¸‹é¢å¯¹æ¯”æ™®é€šçš„çˆ¬è™«å’Œè¿™ç§åˆ†å¸ƒå¼çš„æ•ˆæœ. å¦‚æœæ˜¯æ™®é€šçˆ¬è™«, æˆ‘ç®€åŒ–äº†ä¸€ä¸‹æ¥ä¸‹æ¥çš„ä»£ç , å°†ä¸€äº›ä¸å½±å“çš„ä»£ç å»é™¤æ‰äº†. æˆ‘ä»¬ç”¨å¾ªç¯ä¸€ä¸ªä¸ª <code>crawl</code> <code>unseen</code> é‡Œé¢çš„ url, çˆ¬å‡ºæ¥çš„ HTML æ”¾åˆ° <code>parse</code> é‡Œé¢å»åˆ†æå¾—åˆ°ç»“æœ. æ¥ç€å°±æ˜¯æ›´æ–° <code>seen</code> å’Œ <code>unseen</code> è¿™ä¸¤ä¸ªé›†åˆäº†.</p>
<p><strong>ç‰¹åˆ«æ³¨æ„: ä»»ä½•ç½‘ç«™éƒ½æ˜¯æœ‰ä¸€ä¸ªæœåŠ¡å™¨å‹åŠ›çš„, å¦‚æœä½ çˆ¬çš„è¿‡äºé¢‘ç¹, ç‰¹åˆ«æ˜¯ä½¿ç”¨å¤šè¿›ç¨‹çˆ¬å–æˆ–å¼‚æ­¥çˆ¬å–, ä¸€æ¬¡æ€§æäº¤è¯·æ±‚ç»™æœåŠ¡å™¨å¤ªå¤šæ¬¡, è¿™å°†å¯èƒ½ä¼šä½¿å¾—æœåŠ¡å™¨ç˜«ç—ª, æ‰€ä»¥ä¸ºäº†å®‰å…¨èµ·è§, æˆ‘é™åˆ¶äº†çˆ¬å–æ•°é‡(restricted_crawl=True).</strong> å› ä¸ºæˆ‘æµ‹è¯•ä½¿ç”¨çš„æ˜¯å†…ç½‘ <a href="http://127.0.0.1:4000/" target="_blank" rel="noopener">http://127.0.0.1:4000/</a> æ‰€ä»¥ä¸ä¼šæœ‰è¿™ç§å‹åŠ›. ä½ åœ¨ä»¥åçš„çˆ¬ç½‘é¡µä¸­, ä¼šç»å¸¸é‡åˆ°è¿™æ ·çš„çˆ¬å–æ¬¡æ•°çš„é™åˆ¶ (ç”šè‡³è¢«å°å·). æˆ‘ä»¥å‰çˆ¬ github æ—¶å°±è¢«é™åˆ¶æˆä¸€å°æ—¶åªèƒ½çˆ¬60é¡µ.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DON'T OVER CRAWL THE WEBSITE OR YOU MAY NEVER VISIT AGAIN</span></span><br><span class="line"><span class="keyword">if</span> base_url != <span class="string">"http://127.0.0.1:4000/"</span>:</span><br><span class="line">    restricted_crawl = <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    restricted_crawl = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> len(unseen) != <span class="number">0</span>:                 <span class="comment"># still get some url to visit</span></span><br><span class="line">    <span class="keyword">if</span> restricted_crawl <span class="keyword">and</span> len(seen) &gt;= <span class="number">20</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    htmls = [crawl(url) <span class="keyword">for</span> url <span class="keyword">in</span> unseen]</span><br><span class="line">    results = [parse(html) <span class="keyword">for</span> html <span class="keyword">in</span> htmls]</span><br><span class="line"></span><br><span class="line">    seen.update(unseen)         <span class="comment"># seen the crawled</span></span><br><span class="line">    unseen.clear()              <span class="comment"># nothing unseen</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> title, page_urls, url <span class="keyword">in</span> results:</span><br><span class="line">        unseen.update(page_urls - seen)     <span class="comment"># get new url to crawl</span></span><br></pre></td></tr></tbody></table></figure>

<p>ä½¿ç”¨è¿™ç§å•çº¿ç¨‹çš„æ–¹æ³•, åœ¨æˆ‘çš„å†…ç½‘ä¸Šé¢çˆ¬, çˆ¬å®Œæ•´ä¸ª ç½‘ç«™, ä¸€å…±æ¶ˆè€— <strong>52.3ç§’</strong>. æ¥ç€æˆ‘ä»¬æŠŠå®ƒæ”¹æˆå¤šè¿›ç¨‹åˆ†å¸ƒå¼.</p>
<h4 id="æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•"><a href="#æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•" class="headerlink" title="æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•"></a>æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•</h4><p>è¿˜æ˜¯ä¸Šä¸€ä¸ª <code>while</code> å¾ªç¯, é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ± (Pool).. ç„¶åæˆ‘ä»¬ä¿®æ”¹å¾—åˆ° <code>htmls</code> å’Œ <code>results</code> çš„ä¸¤å¥ä»£ç . å…¶ä»–éƒ½ä¸å˜, åªå°†è¿™ä¸¤ä¸ªåŠŸèƒ½ç»™å¹¶è¡Œäº†. æˆ‘åœ¨è¿™é‡Œå†™çš„éƒ½æ˜¯ç®€åŒ–ä»£ç , </p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pool = mp.Pool(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">while</span> len(unseen) != <span class="number">0</span>:</span><br><span class="line">    <span class="comment"># htmls = [crawl(url) for url in unseen]</span></span><br><span class="line">    <span class="comment"># ---&gt;</span></span><br><span class="line">    crawl_jobs = [pool.apply_async(crawl, args=(url,)) <span class="keyword">for</span> url <span class="keyword">in</span> unseen]</span><br><span class="line">    htmls = [j.get() <span class="keyword">for</span> j <span class="keyword">in</span> crawl_jobs]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># results = [parse(html) for html in htmls]</span></span><br><span class="line">    <span class="comment"># ---&gt;</span></span><br><span class="line">    parse_jobs = [pool.apply_async(parse, args=(html,)) <span class="keyword">for</span> html <span class="keyword">in</span> htmls]</span><br><span class="line">    results = [j.get() <span class="keyword">for</span> j <span class="keyword">in</span> parse_jobs]</span><br><span class="line"></span><br><span class="line">    ...</span><br></pre></td></tr></tbody></table></figure>

<p>è¿˜æ˜¯åœ¨å†…ç½‘æµ‹è¯•, åªç”¨äº† <strong>16.3ç§’</strong>!! è¿™å¯æ¯”ä¸Šé¢çš„å•çº¿ç¨‹çˆ¬è™«å¿«äº†3.5å€. è€Œä¸”æˆ‘è¿˜ä¸æ˜¯åœ¨å¤–ç½‘æµ‹è¯•çš„. å¦‚æœåœ¨å¤–ç½‘, çˆ¬å–ä¸€å¼ ç½‘é¡µçš„æ—¶é—´æ›´é•¿, ä½¿ç”¨å¤šè¿›ç¨‹ä¼šæ›´åŠ æœ‰æ•ˆç‡, èŠ‚çœçš„æ—¶é—´æ›´å¤š.</p>
<p>çœ‹åˆ°è¿™é‡Œ, ä¸€å®šè§‰å¾—å¤šçº¿ç¨‹æ˜¯çˆ¬è™«çš„æ•‘æ˜Ÿ. å…¶å®ä¸ç„¶</p>
<p><strong>ä»£ç å…¨</strong>ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h3 id="åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½"><a href="#åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½" class="headerlink" title="åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½"></a>åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½</h3><p>Python è¿˜æä¾›äº†ä¸€ä¸ªæœ‰åŠ›çš„å·¥å…·, å«åš <a href="https://docs.python.org/3/library/asyncio.html" target="_blank" rel="noopener">asyncio</a>. è¿™æ˜¯ä¸€ä¸ªä»…ä»…ä½¿ç”¨å•çº¿ç¨‹, å°±èƒ½è¾¾åˆ°å¤šçº¿ç¨‹/è¿›ç¨‹çš„æ•ˆæœçš„å·¥å…·. å®ƒçš„åŸç†, ç®€å•è¯´å°±æ˜¯: <strong>åœ¨å•çº¿ç¨‹é‡Œä½¿ç”¨å¼‚æ­¥è®¡ç®—, ä¸‹è½½ç½‘é¡µçš„æ—¶å€™å’Œå¤„ç†ç½‘é¡µçš„æ—¶å€™æ˜¯ä¸è¿ç»­çš„, æ›´æœ‰æ•ˆåˆ©ç”¨äº†ç­‰å¾…ä¸‹è½½çš„è¿™æ®µæ—¶é—´.</strong></p>
<p>ä¼ ç»Ÿçš„å•çº¿ç¨‹ä¸‹è½½å¤„ç†ç½‘é¡µå¯èƒ½å°±åƒæ­¤å›¾(<a href="https://www.nginx.com/blog/thread-pools-boost-performance-9x/" target="_blank" rel="noopener">æ¥æº</a>)å·¦è¾¹è“è‰²é‚£æ ·, è®¡ç®—æœºæ‰§è¡Œä¸€äº›ä»£ç , ç„¶åç­‰å¾…ä¸‹è½½ç½‘é¡µ, ä¸‹å¥½ä»¥å, å†æ‰§è¡Œä¸€äº›ä»£ç â€¦ æˆ–è€…åœ¨ç­‰å¾…çš„æ—¶å€™, ç”¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå…¶ä»–çš„ä»£ç , è¿™æ˜¯å¤šçº¿ç¨‹çš„æ‰‹æ®µ. é‚£ä¹ˆ asyncio å°±åƒå³è¾¹, åªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹, ä½†æ˜¯å°†è¿™äº›ç­‰å¾…æ—¶é—´ç»Ÿç»Ÿææ‰, ä¸‹è½½åº”è¯¥éƒ½è°ƒåˆ°äº†åå°, è¿™ä¸ªæ—¶é—´é‡Œ, æ‰§è¡Œå…¶ä»–å¼‚æ­¥çš„åŠŸèƒ½, ä¸‹è½½å¥½äº†ä¹‹å, å†è°ƒå›æ¥æ¥ç€å¾€ä¸‹æ‰§è¡Œ.</p>
<p>ä»Šå¤©å°±æ¥å°è¯•ä½¿ç”¨ asyncio æ¥æ›¿æ¢æ‰ multiprocessing æˆ–è€… threading, çœ‹çœ‹æ•ˆæœå¦‚ä½•.</p>
<h4 id="Asyncio-åº“"><a href="#Asyncio-åº“" class="headerlink" title="Asyncio åº“"></a>Asyncio åº“</h4><p><a href="https://docs.python.org/3/library/asyncio.html" target="_blank" rel="noopener">Asyncio</a> åº“æ˜¯ Python çš„åŸè£…åº“, ä½†æ˜¯æ˜¯åœ¨ Python 3 çš„æ—¶å€™æå‡ºæ¥çš„, Python 2 å’Œ Python 3.3- æ˜¯æ²¡æœ‰çš„. è€Œä¸” Python 3.5 ä¹‹å, å’Œ Python 3.4 å‰åœ¨è¯­æ³•ä¸Šè¿˜æ˜¯æœ‰äº›ä¸åŒ, æ¯”å¦‚ await å’Œ yield çš„ä½¿ç”¨, ä¸‹é¢çš„æ•™ç¨‹éƒ½æ˜¯åŸºäº Python 3.5+, ä½¿ç”¨ Python3.4 çš„å¯èƒ½ä¼šæ‰§è¡Œæœ‰ç‚¹é—®é¢˜. è°ƒæ•´ä¸€ä¸‹å°±å¥½.</p>
<p>åœ¨ 3.5+ ç‰ˆæœ¬ä¸­, asyncio æœ‰ä¸¤æ ·è¯­æ³•éå¸¸é‡è¦, <code>async</code>, <code>await</code>. å¼„æ‡‚äº†å®ƒä»¬æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„, æˆ‘ä»¬å°±å®Œå…¨èƒ½å‘æŒ¥å‡ºè¿™ä¸ªåº“çš„åŠŸèƒ½äº†. å‰§é€ä¸€ä¸‹, ç­‰ä¼šä½¿ç”¨å•çº¿ç¨‹çˆ¬ç½‘é¡µçš„ asyncio å’Œä¹‹å‰å¤šè¿›ç¨‹å†™çš„çˆ¬ç½‘é¡µæ•ˆæœå·®ä¸å¤š, è€Œä¸”å½“å¹¶è¡Œçš„è¿›ç¨‹æ•°å°‘çš„æ—¶å€™, asyncio æ•ˆæœè¿˜ä¼šæ¯”å¤šè¿›ç¨‹å¿«.</p>
<h4 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><p>æ¥ç€æˆ‘ä»¬æ¥ä¸¾ä¾‹ä»‹ç» asyncio, åƒä¹‹å‰ç”»çš„å›¾é‚£æ ·, æˆ‘ä»¬è¦æ—¶åˆ»è®°ä½, asyncio ä¸æ˜¯å¤šè¿›ç¨‹, ä¹Ÿä¸æ˜¯å¤šçº¿ç¨‹, å•å•æ˜¯ä¸€ä¸ªçº¿ç¨‹, ä½†æ˜¯æ˜¯åœ¨ Python çš„åŠŸèƒ½é—´åˆ‡æ¢ç€æ‰§è¡Œ. åˆ‡æ¢çš„ç‚¹ç”¨ <code>await</code> æ¥æ ‡è®°, èƒ½å¤Ÿå¼‚æ­¥çš„åŠŸèƒ½ç”¨ <code>async</code> æ ‡è®°, æ¯”å¦‚ <code>async def function():</code>. é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹, ä¸ä½¿ç”¨ <code>async</code> å®Œæˆçš„ä¸€ä»½ä»£ç , ç„¶åæˆ‘ä»¬å°†è¿™ä»½ä»£ç æ”¹æˆ <code>async</code> ç‰ˆçš„. </p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸æ˜¯å¼‚æ­¥çš„</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">(t)</span>:</span></span><br><span class="line">    print(<span class="string">'Start job '</span>, t)</span><br><span class="line">    time.sleep(t)               <span class="comment"># wait for "t" seconds</span></span><br><span class="line">    print(<span class="string">'Job '</span>, t, <span class="string">' takes '</span>, t, <span class="string">' s'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    [job(t) <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = time.time()</span><br><span class="line">main()</span><br><span class="line">print(<span class="string">"NO async total time : "</span>, time.time() - t1)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Start job  1</span></span><br><span class="line"><span class="string">Job  1  takes  1  s</span></span><br><span class="line"><span class="string">Start job  2</span></span><br><span class="line"><span class="string">Job  2  takes  2  s</span></span><br><span class="line"><span class="string">NO async total time :  3.008603096008301</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>

<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡º, æˆ‘ä»¬çš„ job æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„, å¿…é¡»æ‰§è¡Œå®Œ <code>job 1</code> æ‰èƒ½å¼€å§‹æ‰§è¡Œ <code>job 2</code>, è€Œä¸” <code>job 1</code> éœ€è¦1ç§’çš„æ‰§è¡Œæ—¶é—´, è€Œ <code>job 2</code> éœ€è¦2ç§’. æ‰€ä»¥æ€»æ—¶é—´æ˜¯ <strong>3 ç§’å¤š</strong>. è€Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ asyncio çš„å½¢å¼, <code>job 1</code> åœ¨ç­‰å¾… <code>time.sleep(t)</code> ç»“æŸçš„æ—¶å€™, æ¯”å¦‚æ˜¯ç­‰å¾…ä¸€ä¸ªç½‘é¡µçš„ä¸‹è½½æˆåŠŸ, åœ¨è¿™ä¸ªåœ°æ–¹æ˜¯å¯ä»¥åˆ‡æ¢ç»™ <code>job 2</code>, è®©å®ƒå¼€å§‹æ‰§è¡Œ.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">(t)</span>:</span>                   <span class="comment"># async å½¢å¼çš„åŠŸèƒ½</span></span><br><span class="line">    print(<span class="string">'Start job '</span>, t)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(t)          <span class="comment"># ç­‰å¾… "t" ç§’, æœŸé—´åˆ‡æ¢å…¶ä»–ä»»åŠ¡</span></span><br><span class="line">    print(<span class="string">'Job '</span>, t, <span class="string">' takes '</span>, t, <span class="string">' s'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(loop)</span>:</span>                       <span class="comment"># async å½¢å¼çš„åŠŸèƒ½</span></span><br><span class="line">    tasks = [</span><br><span class="line">    loop.create_task(job(t)) <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">    ]                                       <span class="comment"># åˆ›å»ºä»»åŠ¡, ä½†æ˜¯ä¸æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.wait(tasks)               <span class="comment"># æ‰§è¡Œå¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span></span><br><span class="line"></span><br><span class="line">t1 = time.time()</span><br><span class="line">loop = asyncio.get_event_loop()             <span class="comment"># å»ºç«‹ loop</span></span><br><span class="line">loop.run_until_complete(main(loop))         <span class="comment"># æ‰§è¡Œ loop</span></span><br><span class="line">loop.close()                                <span class="comment"># å…³é—­ loop</span></span><br><span class="line">print(<span class="string">"Async total time : "</span>, time.time() - t1)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Start job  1</span></span><br><span class="line"><span class="string">Start job  2</span></span><br><span class="line"><span class="string">Job  1  takes  1  s</span></span><br><span class="line"><span class="string">Job  2  takes  2  s</span></span><br><span class="line"><span class="string">Async total time :  2.001495838165283</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>

<p>ä»ç»“æœå¯ä»¥çœ‹å‡º, æˆ‘ä»¬æ²¡æœ‰ç­‰å¾… <code>job 1</code> çš„ç»“æŸæ‰å¼€å§‹ <code>job 2</code>, è€Œæ˜¯ <code>job 1</code> è§¦å‘äº† <code>await</code> çš„æ—¶å€™å°±åˆ‡æ¢åˆ°äº† <code>job 2</code> äº†. è¿™æ—¶, <code>job 1</code> å’Œ <code>job 2</code> åŒæ—¶åœ¨ç­‰å¾… <code>await asyncio.sleep(t)</code>, æ‰€ä»¥æœ€ç»ˆçš„ç¨‹åºå®Œæˆæ—¶é—´, å–å†³äºç­‰å¾…æœ€é•¿çš„ <code>t</code>, ä¹Ÿå°±æ˜¯ <strong>2ç§’</strong>. è¿™å’Œä¸Šé¢ç”¨æ™®é€šå½¢å¼çš„ä»£ç ç›¸æ¯”(3ç§’), çš„ç¡®å¿«äº†å¾ˆå¤š.</p>
<h4 id="aiohttp"><a href="#aiohttp" class="headerlink" title="aiohttp"></a>aiohttp</h4><p>æœ‰äº†å¯¹ asyncio çš„åŸºæœ¬äº†è§£, æˆ‘ä»¬å°±æ¥çœ‹æ€ä¹ˆæŠŠå®ƒç”¨åœ¨çˆ¬è™«. è¿™ä¸ªåŠŸèƒ½å¯¹äºçˆ¬è™«éå¸¸çš„ç†æƒ³, åŸå› å¾ˆç®€å•, æˆ‘ä»¬åœ¨ç­‰å¾…ä¸€ä¸ªç½‘é¡µä¸‹è½½çš„æ—¶å€™, å®Œå…¨å¯ä»¥åˆ‡æ¢åˆ°å…¶å®ƒä»£ç , äº‹åŠåŠŸå€. ä½†æ˜¯ asycio è‡ªå·±è¿˜æ˜¯æ²¡åŠæ³•å®Œæˆè¿™é¡¹ä»»åŠ¡çš„, æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…å¦ä¸€ä¸ªç‰›é€¼çš„æ¨¡å—å°† <code>requests</code> æ¨¡å—ä»£æ›¿æˆä¸€ä¸ªå¼‚æ­¥çš„ <code>requests</code>, è¿™ä¸ªç‰›é€¼çš„æ¨¡å—å«ä½œ <code>aiohttp</code> (<a href="https://aiohttp.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">å®˜ç½‘åœ¨è¿™</a>). ä¸‹è½½å®‰è£…ç‰¹åˆ«ç®€å•. ç›´æ¥åœ¨ä½ çš„ terminal æˆ–è€… cmd é‡Œé¢è¾“å…¥ pip3 install aiohttp.</p>
<p>æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬æ€ä¹ˆç”¨æœ€ä¸€èˆ¬çš„ requests æ¨¡å—çˆ¬ç½‘é¡µ, å’Œæˆ‘ä»¬æ€ä¹ˆå°† requests æ›¿æ¢æˆ aiohttp.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">URL = <span class="string">'https://xxx.com/'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normal</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        r = requests.get(URL)</span><br><span class="line">        url = r.url</span><br><span class="line">        print(url)</span><br><span class="line"></span><br><span class="line">t1 = time.time()</span><br><span class="line">normal()</span><br><span class="line">print(<span class="string">"Normal total time:"</span>, time.time()-t1)</span><br></pre></td></tr></tbody></table></figure>

<p>ç„¶åæˆ‘ä»¬åœ¨ç”¨ <a href="https://aiohttp.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">aiohttp</a> æ¥å®ç°ä¸€æ ·çš„åŠŸèƒ½</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">(session)</span>:</span></span><br><span class="line">    response = <span class="keyword">await</span> session.get(URL)       <span class="comment"># ç­‰å¾…å¹¶åˆ‡æ¢</span></span><br><span class="line">    <span class="keyword">return</span> str(response.url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(loop)</span>:</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:      <span class="comment"># å®˜ç½‘æ¨èå»ºç«‹ Session çš„å½¢å¼</span></span><br><span class="line">        tasks = [loop.create_task(job(session)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)]</span><br><span class="line">        finished, unfinished = <span class="keyword">await</span> asyncio.wait(tasks)</span><br><span class="line">        all_results = [r.result() <span class="keyword">for</span> r <span class="keyword">in</span> finished]    <span class="comment"># è·å–æ‰€æœ‰ç»“æœ</span></span><br><span class="line">        print(all_results)</span><br><span class="line"></span><br><span class="line">t1 = time.time()</span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">loop.run_until_complete(main(loop))</span><br><span class="line">loop.close()</span><br><span class="line">print(<span class="string">"Async total time:"</span>, time.time() - t1)</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ª Session, è¿™æ˜¯å®˜ç½‘æ¨èçš„æ–¹å¼, ä½†æ˜¯æˆ‘è§‰å¾—ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ request å½¢å¼, ç»†èŠ‚è¯·å‚è€ƒ<a href="https://aiohttp.readthedocs.io/en/stable/client.html#make-a-request" target="_blank" rel="noopener">å®˜æ–¹è¯´æ˜</a>. å¦‚æœè¦è·å–ç½‘é¡µè¿”å›çš„ç»“æœ, æˆ‘ä»¬å¯ä»¥åœ¨ <code>job()</code> ä¸­ return ä¸ªç»“æœå‡ºæ¥, ç„¶åå†åœ¨ <code>finished, unfinished = await asyncio.wait(tasks)</code> æ”¶é›†å®Œæˆçš„ç»“æœ, è¿™é‡Œå®ƒä¼šè¿”å›å®Œæˆçš„å’Œæ²¡å®Œæˆçš„, æˆ‘ä»¬å…³å¿ƒçš„éƒ½æ˜¯å®Œæˆçš„, è€Œä¸” <code>await</code> ä¹Ÿç¡®å®æ˜¯ç­‰å¾…éƒ½å®Œæˆäº†æ‰è¿”å›. çœŸæ­£çš„ç»“æœè¢«å­˜æ”¾åœ¨äº† <code>result()</code> é‡Œé¢.</p>
<h4 id="å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”"><a href="#å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”" class="headerlink" title="å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”"></a>å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”</h4><p>æœ‰äº†è¿™äº›åŸºç¡€, æˆ‘ä»¬å°±å¯ä»¥æ¥ç©ç‚¹é«˜çº§çš„äº†, ä¹‹å‰æˆ‘ä»¬ç”¨ multiprocessing å†™è¿‡äº†ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒå¼çˆ¬è™«, ç°åœ¨æˆ‘ä»¬å°±æ¥æ‹¿è¿‡æ¥ PK ä¸€ä¸‹ asyncio çš„æ–¹æ³•. é¦–å…ˆæˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹è¿™æ¬¡å†™çš„ç»“æ„å’Œä¸Šæ¬¡å†™çš„ç®€å•åˆ†å¸ƒå¼çˆ¬è™«çš„åŒºåˆ«. åˆ†å¸ƒå¼æˆ‘ä»¬å®Œå…¨ä¾èµ–çš„æ˜¯ multiprocessing è¿™ä¸ªæ¨¡å—. ä½¿ç”¨ python å¼ºå¤§çš„å¹¶è¡Œå¤„ç†è¿ç®—æ¥ä¸‹è½½æˆ‘ä»¬è¦å¤„ç†çš„ urls, ç„¶åè§£æç½‘é¡µä¹Ÿæ˜¯ä¸€ä»¶è€—æ—¶çš„äº‹, ç‰¹åˆ«æ˜¯ç½‘é¡µé‡å¤šçš„æ—¶å€™. æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†ç½‘é¡µè§£æç»™å¹¶è¡Œäº†. è¿™æ ·å¤§å¤§èŠ‚çœäº†ä¸‹è½½å’Œè¿ç®—æ—¶é—´. å†çœ‹å³è¾¹çš„è¿™ä¸ª asyncio çš„ä¾‹å­, æˆ‘ä»¬è§£æç½‘é¡µè¿˜æ˜¯ç”¨çš„å’Œ multiprocessing é‚£è¾¹ä¸€æ ·çš„å¹¶è¡Œå¤„ç†, å› ä¸º asyncio å¥½åƒä¸æ”¯æŒè§£æç½‘é¡µçš„å¼‚æ­¥, æ¯•ç«Ÿæ˜¯è®¡ç®—å¯†é›†å‹å·¥åº. ç„¶åä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯, æˆ‘ä»¬åœ¨ä¸‹è½½ç½‘é¡µæ—¶, ä¸ç”¨ multiprocessing, æ”¹ç”¨ asyncio, ç”¨ä¸€ä¸ªå•çº¿ç¨‹çš„ä¸œè¥¿æŒ‘æˆ˜å¤šè¿›ç¨‹.</p>
<p>æˆ‘ä»¬å‘ç°, å¦‚æœ <code>Pool(n)</code> é‡Œé¢çš„è¿™ä¸ª n è¶Šå¤§, å¤šè¿›ç¨‹æ‰èƒ½è¶Šå¿«, ä½†æ˜¯ asyncio å´ä¸ä¼šç‰¹åˆ«å—è¿›ç¨‹æ•°çš„å½±å“. ä¸€ä¸ªå•çº¿ç¨‹çš„ä¸œè¥¿å±…ç„¶æˆ˜èƒœäº†å¤šè¿›ç¨‹. å¯è§å¼‚æ­¥ asyncio ä¸‹è½½ç½‘é¡µçš„é‡è¦æ€§.</p>
<p>ä¸Šé¢ä»‹ç»çš„è¿˜åªæ˜¯ asyncio çš„ä¸€å°éƒ¨åˆ†åŠŸèƒ½, å¦‚æœæƒ³äº†è§£æ›´å¤šæœ‰å…³äº asyncio çš„ä½¿ç”¨æ–¹æ³•, è¯·çœ‹åˆ° Python çš„<a href="https://docs.python.org/3/library/asyncio.html" target="_blank" rel="noopener">å®˜æ–¹ä»‹ç»</a>.</p>
<h3 id="é«˜çº§çˆ¬è™«ï¼šè®©-Selenium-æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬"><a href="#é«˜çº§çˆ¬è™«ï¼šè®©-Selenium-æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬" class="headerlink" title="é«˜çº§çˆ¬è™«ï¼šè®© Selenium æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬"></a>é«˜çº§çˆ¬è™«ï¼š<strong>è®© Selenium æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬</strong></h3><blockquote>
<p>Selenium æ˜¯ä¸ºäº†æµ‹è¯•è€Œå‡ºç”Ÿçš„. ä½†æ˜¯æ²¡æƒ³åˆ°åˆ°äº†çˆ¬è™«çš„å¹´ä»£, å®ƒæ‘‡èº«ä¸€å˜, å˜æˆäº†çˆ¬è™«çš„å¥½å·¥å…·. è®©æˆ‘è¯•ç€ç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬ Seleninm: <strong>å®ƒèƒ½æ§åˆ¶ä½ çš„æµè§ˆå™¨, æœ‰æ¨¡æœ‰æ ·åœ°å­¦äººç±»çœ‹ç½‘é¡µ</strong>.</p>
</blockquote>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>å› ä¸º Selenium éœ€è¦æ“æ§ä½ çš„æµè§ˆå™¨, æ‰€ä»¥å®‰è£…èµ·æ¥æ¯”ä¼ ç»Ÿçš„ Python æ¨¡å—è¦å¤šå‡ æ­¥. å…ˆåœ¨ terminal æˆ–è€… cmd ç”¨ pip å®‰è£… selenium.</p>
<p>è¦æ“æ§æµè§ˆå™¨, ä½ å°±è¦æœ‰æµè§ˆå™¨çš„ driver. Selenium é’ˆå¯¹å‡ ä¸ªä¸»æµçš„æµè§ˆå™¨éƒ½æœ‰ driver. <strong>é’ˆå¯¹ Linux å’Œ MacOS</strong>.</p>
<ul>
<li>Chrome <a href="https://sites.google.com/a/chromium.org/chromedriver/downloads" target="_blank" rel="noopener">driver</a>, å¦‚æœå‰é¢é“¾æ¥æ— æ³•æ‰“å¼€, è¯·å°è¯•<a href="https://npm.taobao.org/mirrors/chromedriver" target="_blank" rel="noopener">è¿™ä¸ª</a>, å¹¶ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„ driver</li>
<li>Edge <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/" target="_blank" rel="noopener">driver</a></li>
<li>Firefox <a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener">driver</a></li>
<li>Safari <a href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/" target="_blank" rel="noopener">driver</a></li>
</ul>
<p>Linux å’Œ MacOS ç”¨æˆ·ä¸‹è½½å¥½ä¹‹å, è¯·å°†ä¸‹è½½å¥½çš„geckodriveræ–‡ä»¶æ”¾åœ¨ä½ çš„è®¡ç®—æœºçš„ /usr/bin æˆ– /usr/local/bin ç›®å½•. å¹¶èµ‹äºˆæ‰§è¡Œæƒé™, ä¸ä¼šæ”¾çš„, è¯·ä½¿ç”¨è¿™æ¡è¯­å¥.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp ä½ çš„geckodriverä½ç½® /usr/local/bin</span><br><span class="line">sudo chmod +x /usr/local/bin/geckodriver</span><br></pre></td></tr></tbody></table></figure>

<p>å¯¹äº Windows ç”¨æˆ·, å®˜ç½‘ä¸Šçš„<a href="http://selenium-python.readthedocs.io/installation.html#detailed-instructions-for-windows-users" target="_blank" rel="noopener">è¯´æ³•</a>, å¥½åƒæ²¡æœ‰æåˆ°è¦å…·ä½“æ€ä¹ˆæ“ä½œ, æˆ‘æƒ³, åº”è¯¥æ˜¯æŠŠ geckodriver è¿™ä¸ªæ–‡ä»¶çš„ä½ç½®åŠ åœ¨ Windows çš„ç¯å¢ƒå˜é‡ä¸­(PATH).</p>
<p>å¦‚æœä½ å®‰è£…æœ‰ä»»ä½•çš„é—®é¢˜, è¯·åœ¨å®ƒä»¬çš„<a href="http://selenium-python.readthedocs.io/installation.html" target="_blank" rel="noopener">å®˜ç½‘</a>ä¸ŠæŸ¥è¯¢è§£å†³æ–¹æ¡ˆ.</p>
<h4 id="å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶"><a href="#å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶" class="headerlink" title="å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶"></a>å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶</h4><p>åœ¨è¿™æ•™ä½ ç”¨<a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank" rel="noopener">ç«ç‹æµè§ˆå™¨</a>å·æ‡’çš„ä¸€æ‹›, å› ä¸ºæš‚æ—¶åªæœ‰ç«ç‹ä¸Šæœ‰è¿™ä¸ªæ’ä»¶. æ’ä»¶ Katalon Recorder ä¸‹è½½çš„ç½‘å€<a href="https://addons.mozilla.org/en-US/firefox/addon/katalon-automation-record/" target="_blank" rel="noopener">åœ¨è¿™</a></p>
<p>è¿™ä¸ªæ’ä»¶èƒ½è®©ä½ è®°å½•ä½ ä½¿ç”¨æµè§ˆå™¨çš„æ“ä½œ. æˆ‘ä»¥å‰ç©ç½‘æ¸¸, ä¸ºäº†å·æ‡’, ç”¨è¿‡ä¸€ä¸ªå«æŒ‰é”®ç²¾çµçš„ä¸œè¥¿, å¸®æˆ‘åšäº†å¾ˆå¤šé‡å¤æ€§çš„å·¥ä½œ, æ‹¯æ•‘äº†æˆ‘çš„é¼ æ ‡å’Œé”®ç›˜, å½“ç„¶è¿˜æœ‰æˆ‘çš„æ‰‹æŒ‡! çœ‹ç€åˆ«äººä¸€ç›´åœ¨ç‚¹é¼ æ ‡, æˆ‘å¿ƒä¸­æš—çˆ½~ è¿™ä¸ª Katalon Recorder æ’ä»¶ + Selenium å°±å’ŒæŒ‰é”®ç²¾çµæ˜¯ä¸€ä¸ªæ„æ€. è®°å½•ä½ çš„æ“ä½œ, ç„¶åä½ å¯ä»¥è®©ç”µè„‘é‡å¤ä¸Šåƒé.</p>
<p>å®‰è£…å¥½ç«ç‹ä¸Šçš„è¿™ä¸ªæ’ä»¶å, æ‰“å¼€å®ƒ.</p>
<p>æ‰¾åˆ°æ’ä»¶ä¸Šçš„ record, ç‚¹å®ƒ. ç„¶åç”¨ç«ç‹ç™»å½•ä¸Š æŸä¸ªç½‘ç«™, å¼€å§‹ä½ çš„å„ç§ç‚¹å‡»å·¥ä½œ,</p>
<p>æ¯å½“ä½ ç‚¹å‡»çš„æ—¶å€™, æ’ä»¶å°±ä¼šè®°å½•ä¸‹ä½ è¿™äº›ç‚¹å‡», å½¢æˆä¸€äº›log. æœ€åç¥å¥‡çš„äº‹æƒ…å°†è¦å‘ç”Ÿ. ä½ å¯ä»¥ç‚¹å‡» Export æŒ‰é’®, è§‚çœ‹åˆ°å¸®ä½ ç”Ÿæˆçš„æµè§ˆè®°å½•ä»£ç !</p>
<p>è™½ç„¶è¿™ä¸ªä»£ç è¾“å‡ºåªæœ‰ Python2 ç‰ˆæœ¬çš„, ä¸è¿‡ä¸å½±å“. æˆ‘ä»¬ç›´æ¥å°†è¿™äº›åœˆèµ·æ¥çš„ä»£ç å¤åˆ¶. è¿™å°†ä¼šæ˜¯ python å¸®ä½ æ‰§è¡Œçš„è¡Œä¸ºä»£ç .</p>
<h4 id="Python-æ§åˆ¶æµè§ˆå™¨"><a href="#Python-æ§åˆ¶æµè§ˆå™¨" class="headerlink" title="Python æ§åˆ¶æµè§ˆå™¨"></a>Python æ§åˆ¶æµè§ˆå™¨</h4><p>å¥½äº†, æœ‰äº†è¿™äº›ä»£ç , æˆ‘ä»¬å°±èƒ½å›åˆ° Python. å¼€å§‹å†™ Python çš„ä»£ç äº†. è¿™é‡Œååˆ†ç®€å•! æˆ‘å°† selenium ç»‘å®šåˆ° Chrome ä¸Š <code>webdriver.Chrome()</code>. ä½ å¯ä»¥ç»‘å…¶å®ƒçš„æµè§ˆå™¨.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()     <span class="comment"># æ‰“å¼€ Chrome æµè§ˆå™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†åˆšåˆšå¤åˆ¶çš„å¸–åœ¨è¿™</span></span><br><span class="line">driver.get(<span class="string">"https://xxx.com/"</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">u"//img[@alt='å¼ºåŒ–å­¦ä¹  (Reinforcement Learning)']"</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">"About"</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">u"èµåŠ©"</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">u"æ•™ç¨‹ â–¾"</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">u"æ•°æ®å¤„ç† â–¾"</span>).click()</span><br><span class="line">driver.find_element_by_link_text(<span class="string">u"ç½‘é¡µçˆ¬è™«"</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—åˆ°ç½‘é¡µ html, è¿˜èƒ½æˆªå›¾</span></span><br><span class="line">html = driver.page_source       <span class="comment"># get html</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">"./img/sreenshot1.png"</span>)</span><br><span class="line">driver.close()</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬èƒ½å¾—åˆ°é¡µé¢çš„ html code (<code>driver.page_source</code>), å°±èƒ½åŸºäºè¿™ä¸ª code æ¥çˆ¬å–æ•°æ®äº†. </p>
<p>ä¸è¿‡æ¯æ¬¡éƒ½è¦çœ‹ç€æµè§ˆå™¨æ‰§è¡Œè¿™äº›æ“ä½œ, æœ‰æ—¶å€™æœ‰ç‚¹ä¸æ–¹ä¾¿. æˆ‘ä»¬å¯ä»¥è®© selenium ä¸å¼¹å‡ºæµè§ˆå™¨çª—å£, è®©å®ƒå®‰é™åœ°æ‰§è¡Œæ“ä½œ. åœ¨åˆ›å»º <code>driver</code> ä¹‹å‰å®šä¹‰å‡ ä¸ªå‚æ•°å°±èƒ½æ‘†è„±æµè§ˆå™¨çš„èº«ä½“äº†.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"></span><br><span class="line">chrome_options = Options()</span><br><span class="line">chrome_options.add_argument(<span class="string">"--headless"</span>)       <span class="comment"># define headless</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(chrome_options=chrome_options)</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<p>Selenium èƒ½åšçš„äº‹è¿˜æœ‰å¾ˆå¤š, æ¯”å¦‚å¡« Form è¡¨å•, è¶…æ§é”®ç›˜ç­‰ç­‰. è¿™ä¸ªæ•™ç¨‹ä¸ä¼šç»†è¯´äº†, åªæ˜¯ä¸ªå…¥é—¨, å¦‚æœä½ è¿˜æƒ³ç»§ç»­æ·±å…¥äº†è§£, æ¬¢è¿ç‚¹è¿›å»<a href="http://selenium-python.readthedocs.io/" target="_blank" rel="noopener">ä»–ä»¬çš„ Python æ•™å­¦å®˜ç½‘</a>.</p>
<p>æœ€å, Selenium çš„ä¼˜ç‚¹æˆ‘ä»¬éƒ½çœ‹å‡ºæ¥äº†, å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®ä½ æ¨¡æ‹Ÿä½ çš„æ“ä½œ, æ·»åŠ å…¶å®ƒæ“ä½œä¹Ÿæ˜¯éå¸¸å®¹æ˜“çš„, ä½†æ˜¯ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„, ä¸æ˜¯ä»»ä½•æ—¶å€™ selenium éƒ½å¾ˆå¥½. å› ä¸ºè¦æ‰“å¼€æµè§ˆå™¨, åŠ è½½æ›´å¤šä¸œè¥¿, å®ƒçš„æ‰§è¡Œé€Ÿåº¦è‚¯å®šæ²¡æœ‰å…¶å®ƒæ¨¡å—å¿«. æ‰€ä»¥å¦‚æœä½ éœ€è¦é€Ÿåº¦, èƒ½ä¸ç”¨ Selenium, å°±ä¸ç”¨å§.</p>
<h4 id="é«˜çº§çˆ¬è™«-é«˜æ•ˆæ— å¿§çš„-Scrapy-çˆ¬è™«åº“"><a href="#é«˜çº§çˆ¬è™«-é«˜æ•ˆæ— å¿§çš„-Scrapy-çˆ¬è™«åº“" class="headerlink" title="é«˜çº§çˆ¬è™«: é«˜æ•ˆæ— å¿§çš„ Scrapy çˆ¬è™«åº“"></a><strong>é«˜çº§çˆ¬è™«: é«˜æ•ˆæ— å¿§çš„ Scrapy çˆ¬è™«åº“</strong></h4><blockquote>
<p> å¦‚æœä½ æƒ³æ›´é«˜æ•ˆçš„å¼€å‘, çˆ¬å–ç½‘é¡µ, è®°å½•æ•°æ®åº“, Scrapy æ˜¯å€¼å¾—ä¸€æ¨çš„. å®ƒæ˜¯ä¸€ä¸ªçˆ¬è™«çš„æ¡†æ¶, è€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„çˆ¬è™«. å®ƒæ•´åˆäº†çˆ¬å–, å¤„ç†æ•°æ®, å­˜å‚¨æ•°æ®çš„ä¸€æ¡é¾™æœåŠ¡. å¦‚æœä½ åªéœ€è¦å¶å°”çš„ä¸€ä¸¤æ¬¡çˆ¬çˆ¬ç½‘é¡µ, å‰é¢çš„æ•™ç¨‹å·²ç»å¤Ÿäº†, å¦‚æœä½ éœ€è¦æ¯å¤©é çˆ¬è™«åƒé¥­, Scrapy è¿˜æ˜¯æœ‰å¿…è¦äº†è§£çš„</p>
<p>è¿™é‡Œä½ å†™å‡ºä¸€ä¸ª Scrapy å½¢å¼çš„çˆ¬è™«, å¸¦ä½ å…¥é—¨ Scrapy, ä½†æ˜¯ Scrapy ä¸ä»…ä»…åªæœ‰çˆ¬è™«, ä½ éœ€è¦å­¦ä¹ æ›´å¤š. é‚£å­¦ä¹  Scrapy çš„åœ°æ–¹, å½“ç„¶æ˜¯ä»–ä»¬<a href="https://docs.scrapy.org/en/latest/" target="_blank" rel="noopener">è‡ªå®¶ç½‘ç«™</a>å’¯.</p>
</blockquote>
<h4 id="Scrapy-çš„ä¼˜åŠ¿"><a href="#Scrapy-çš„ä¼˜åŠ¿" class="headerlink" title="Scrapy çš„ä¼˜åŠ¿"></a>Scrapy çš„ä¼˜åŠ¿</h4><p>Scrapy æ˜¯ä¸€ä¸ªæ•´åˆäº†çš„çˆ¬è™«æ¡†æ¶, æœ‰ç€éå¸¸å¥å…¨çš„ç®¡ç†ç³»ç»Ÿ. è€Œä¸”å®ƒä¹Ÿæ˜¯åˆ†å¸ƒå¼çˆ¬è™«, ä½†æ˜¯æ¯”æˆ‘ä»¬ä¹‹å‰å†™çš„é‚£ä¸ªåˆ†å¸ƒå¼çˆ¬è™«é«˜çº§å¤šäº†. è¿™é‡Œæ˜¯ Scrapy çš„æ¡†æ¶ç¤ºæ„å›¾(<a href="https://docs.scrapy.org/en/latest/topics/architecture.html#topics-architecture" target="_blank" rel="noopener">å›¾æº</a>). å®ƒçš„ç®¡ç†ä½“ç³»éå¸¸å¤æ‚. ä½†æ˜¯ç‰¹åˆ«é«˜æ•ˆ. è®©ä½ åˆåˆ·ç½‘é¡µ, åˆä¸‹è½½, åŒæ—¶èƒ½å¤„ç†æ•°æ®. ç®€ç›´åƒæ‰‹è§‚éŸ³å‘€.</p>
<p>è€Œä¸”åš Scrapy çš„é¡¹ç›®, ç»å¯¹ä¸æ˜¯åªéœ€è¦å†™ä¸€ä¸ªè„šæœ¬å°±èƒ½è§£å†³çš„. ä¸ºäº†æŠŠä½ å¸¦å…¥é—¨, è¿™æ¬¡æˆ‘ä»¬åªå†™ä¸€ä¸ªè„šæœ¬, åªæ¶‰åŠé‡Œé¢çš„çˆ¬è™«(spider)éƒ¨åˆ†. å…¶ä»–çš„éƒ¨åˆ†ä½ å¯ä»¥åœ¨è¿™é‡Œæ·±å…¥å­¦ä¹ .</p>
<ul>
<li>å®˜ç½‘æ•™ç¨‹ <a href="https://docs.scrapy.org/en/latest/" target="_blank" rel="noopener">è‹±æ–‡</a>, <a href="https://scrapy-chs.readthedocs.io/zh_CN/0.24/" target="_blank" rel="noopener">ä¸­æ–‡</a></li>
<li>JasonDing çš„<a href="https://www.jianshu.com/p/a8aad3bf4dc4" target="_blank" rel="noopener">å­¦ä¹ Scrapyå…¥é—¨</a></li>
<li>young-hz çš„<a href="http://blog.csdn.net/u012150179/article/details/32343635" target="_blank" rel="noopener">Scrapyç ”ç©¶æ¢ç´¢ç³»åˆ—</a></li>
</ul>
<h4 id="Scrapy-çˆ¬è™«"><a href="#Scrapy-çˆ¬è™«" class="headerlink" title="Scrapy çˆ¬è™«"></a>Scrapy çˆ¬è™«</h4><p>é¦–å…ˆä½ å¾—å®‰è£… Scrapy. åœ¨ terminal æˆ–è€… cmd ä½¿ç”¨ pip å®‰è£…å°±å¥½.</p>
<p>å¦‚æœå®‰è£…é‡åˆ°ä»»ä½•é—®é¢˜, å®ƒä»¬å®¶çš„<a href="https://docs.scrapy.org/en/latest/intro/install.html" target="_blank" rel="noopener">ç½‘ç«™</a>æ˜¯ä¸ªå¥½å»å¤„.</p>
<p>æˆ‘ä»¬å¯¼å…¥ scrapy æ¨¡å—, å¹¶åˆ›å»ºä¸€ä¸ª spider çš„ class. å¹¶ç»§æ‰¿ <code>scrapy.Spider</code>, ä¸€å®šè¿˜è¦ç»™è¿™ä¸ª spider ä¸€ä¸ªåå­—, æˆ‘å°±ç”¨ <code>mofan</code> å¥½äº†, å› ä¸ºæ˜¯çˆ¬ è«çƒ¦Python çš„. ç»™å®šä¸€äº›åˆå§‹çˆ¬å–çš„ç½‘é¡µ, å†™åœ¨ <code>start_urls</code> é‡Œ. è¿™é‡Œç‰¹åˆ«è¦æçš„æ˜¯: <strong>ä¹‹å‰æˆ‘ä»¬ç”¨ python çš„ set æ¥å»é™¤é‡å¤çš„ url, åœ¨ scrapy ä¸­, è¿™æ˜¯ä¸éœ€è¦çš„, å› ä¸ºå®ƒè‡ªåŠ¨å¸®ä½ å»é‡</strong>. </p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MofanSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">"mofan"</span></span><br><span class="line">    start_urls = [</span><br><span class="line">        <span class="string">'https://xxx.com/'</span>,</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment"># unseen = set()</span></span><br><span class="line">    <span class="comment"># seen = set()      # æˆ‘ä»¬ä¸åœ¨éœ€è¦ set äº†, å®ƒè‡ªåŠ¨å»é‡</span></span><br></pre></td></tr></tbody></table></figure>

<p>æ¥ç€æˆ‘ä»¬è¿˜è¦å®šä¹‰è¿™ä¸ª class ä¸­çš„ä¸€ä¸ªåŠŸèƒ½å°±èƒ½å®Œäº‹äº†. æˆ‘ä»¬ä½¿ç”¨ python çš„ <code>yield</code> æ¥è¿”å›æœé›†åˆ°çš„æ•°æ® (ä¸ºä»€ä¹ˆæ˜¯yield? å› ä¸ºåœ¨ scrapy ä¸­ä¹Ÿæœ‰å¼‚æ­¥å¤„ç†, åŠ é€Ÿæ•´ä½“æ•ˆç‡). è¿™äº› title å’Œ url çš„æ•°æ®, æˆ‘ä»¬éƒ½æ˜¯ç”¨ scrapy ä¸­<a href="https://docs.scrapy.org/en/latest/intro/tutorial.html#extracting-data" target="_blank" rel="noopener">æŠ“å–ä¿¡æ¯çš„æ–¹å¼</a>.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MofanSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="keyword">yield</span> {     <span class="comment"># return some results</span></span><br><span class="line">            <span class="string">'title'</span>: response.css(<span class="string">'h1::text'</span>).extract_first(default=<span class="string">'Missing'</span>).strip().replace(<span class="string">'"'</span>, <span class="string">""</span>),</span><br><span class="line">            <span class="string">'url'</span>: response.url,</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        urls = response.css(<span class="string">'a::attr(href)'</span>).re(<span class="string">r'^/.+?/$'</span>)     <span class="comment"># find all sub urls</span></span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">            <span class="keyword">yield</span> response.follow(url, callback=self.parse)     <span class="comment"># it will filter duplication automatically</span></span><br></pre></td></tr></tbody></table></figure>

<p>ç„¶ååœ¨è¿™ä¸ªresponseç½‘é¡µä¸­ç­›é€‰ <code>urls</code>, è¿™é‡Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦ä½¿ç”¨ <code>urljoin()</code> è¿™ç§åŠŸèƒ½ç»™ url æ”¹å˜å½¢å¼. å®ƒåœ¨ <code>follow()</code> è¿™ä¸€æ­¥ä¼šè‡ªåŠ¨æ£€æµ‹ url çš„æ ¼å¼. (çœŸæ˜¯çœå¿ƒå•Š<del>), ç„¶åå¯¹äºæ¯ä¸ªæ‰¾åˆ°çš„ url, ç„¶å yield é‡æ–°ä½¿ç”¨ <code>self.parse()</code> æ¥çˆ¬å–, è¿™é‡Œåˆæ˜¯è‡ªåŠ¨å»é‡! Scrapy ä»¿ä½›çŸ¥é“ä½ æœ€ä¸æƒ³åšä»€ä¹ˆ, å®ƒè‡ªåŠ¨å¸®ä½ éƒ½åšå¥½äº†. å¼€å¿ƒ</del></p>
<p>æœ€åéœ€è¦è¿è¡Œçš„æ—¶å€™æœ‰ç‚¹ä¸åŒ, ä½ éœ€è¦åœ¨ terminal æˆ– cmd ä¸­è¿è¡Œè¿™ä¸ªçˆ¬è™«. è€Œä¸”è¿˜èƒ½å¸®ä½ ä¿å­˜åˆšåˆš yield çš„ <code>{title:, url:}</code> çš„ç»“æœ. <code>runspider 5-2-scrapy.py</code> å°±æ˜¯é€‰æ‹©ä½ è¦è·‘çš„è¿™ä¸ª Python æ–‡ä»¶.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ scrapy runspider 5-2-scrapy.py -o res.json</span><br></pre></td></tr></tbody></table></figure>

<p><code>-o res.json</code> è¿™ä¸ª <code>-o</code> å°±æ˜¯è¾“å‡ºçš„æŒ‡ä»¤, ä½ å¯ä»¥åœ¨é‚£ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ä¸€ä¸ªåå­—å« <code>res.json</code> çš„æ–‡ä»¶, é‡Œé¢å­˜æœ‰æ‰€æœ‰æ‰¾åˆ°çš„ <code>{title:, url:}</code>.</p>
<p>å…¶å®æˆ‘ä»¬åªåšäº† scrapy ä¸­çš„çˆ¬è™«, ä¸€ä¸ªæ­£å¸¸çš„ scrapy é¡¹ç›®è¿˜åŒ…æ‹¬æœ‰å¾ˆå¤šå…¶ä»–çš„å†…å®¹(è§ä¸‹é¢). è¿™ä¸ªæ•™ç¨‹å°±ä¸ä¼šç»†è¯´äº†, å› ä¸ºå­¦å¥½ scrapy è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„. ä½ å¯ä»¥åœ¨ä¸Šé¢æ¨èç»™ä½ çš„é“¾æ¥ä¸­, ç»§ç»­æ·±å…¥å­¦ä¹  scrapy.</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>
    
    
    
	
	<div>
		
			<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
		
	</div>
	  
		<div>
		  <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/bolg_mask.png" alt="äº‘æ¾ˆ wechat" style="width: 200px; max-width: 100%;"/>
    <div>æ‰«ä¸€æ‰«ï¼Œç”¨æ‰‹æœºè®¿é—®å“¦</div>
</div>

		</div>
	  

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>åšæŒåŸåˆ›æŠ€æœ¯åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="https://i.loli.net/2020/06/10/PNbxe7H5KXJgcoh.jpg" alt="äº‘æ¾ˆ å¾®ä¿¡æ”¯ä»˜"/>
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="https://i.loli.net/2020/06/10/FQkTKeyYndB5WhP.jpg" alt="äº‘æ¾ˆ æ”¯ä»˜å®"/>
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    äº‘æ¾ˆ
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://liudufu.github.io/Getting_Started_with_Request_Crawler/" title="requestçˆ¬è™«å…¥é—¨">https://liudufu.github.io/Getting_Started_with_Request_Crawler/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
          
            <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> å­¦ä¹ ç¬”è®°</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Introduction_to_RE_Regularization/" rel="next" title="reæ­£åˆ™å…¥é—¨">
                reæ­£åˆ™å…¥é—¨ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC81MDQzNi8yNjkyMw"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
			  <a href="/">
                <img class="site-author-image" itemprop="image"
                  src="https://s1.ax1x.com/2020/07/20/UfbOPJ.jpg"
                  alt="äº‘æ¾ˆ" />
			  </a>
            
              <p class="site-author-name" itemprop="name">äº‘æ¾ˆ</p>
              <p class="site-description motion-element" itemprop="description">Time would heal almost all wounds,if your wounds have not been healed up.please wait for a short while</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">75</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">106</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/liudufu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:2649176532@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/liudufu" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://me.csdn.net/weixin_45333934" target="_blank" title="csdn">
                      
                        <i class="fa fa-fw fa-heartbeat"></i>csdn</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/yourname" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.cnblogs.com/dufu-csdn/" target="_blank" title="åšå®¢å›­">
                      
                        <i class="fa fa-fw fa-instagram"></i>åšå®¢å›­</a>
                  </span>
                
            </div>
          
		  
		  
		  
		    <div class="links-of-blogroll motion-element links-of-blogroll-block">
			  <div class="links-of-blogroll-title">
			    <!-- modify icon to fire by szw -->
			    <i class="fa fa-history fa-" aria-hidden="true"></i>
			    è¿‘æœŸæ–‡ç« 
			  </div>
			  <ul class="links-of-blogroll-list">
			    
			    
				  <li class="recent_posts_li">
				    <a href="/Getting_Started_with_Request_Crawler/" title="requestçˆ¬è™«å…¥é—¨" target="_blank">requestçˆ¬è™«å…¥é—¨</a>
				  </li>
			    
				  <li class="recent_posts_li">
				    <a href="/Introduction_to_RE_Regularization/" title="reæ­£åˆ™å…¥é—¨" target="_blank">reæ­£åˆ™å…¥é—¨</a>
				  </li>
			    
				  <li class="recent_posts_li">
				    <a href="/knowledge_C_language/" title="Easy to mix knowledge points of C language" target="_blank">Easy to mix knowledge points of C language</a>
				  </li>
			    
				  <li class="recent_posts_li">
				    <a href="/Servlet_Basics/" title="servletåŸºç¡€" target="_blank">servletåŸºç¡€</a>
				  </li>
			    
				  <li class="recent_posts_li">
				    <a href="/The_difference_and_basic_usage_of_JPA_and_JDBC/" title="JPAä¸JDBCçš„åŒºåˆ«å’ŒåŸºæœ¬ç”¨æ³•" target="_blank">JPAä¸JDBCçš„åŒºåˆ«å’ŒåŸºæœ¬ç”¨æ³•</a>
				  </li>
			    
			  </ul>
		    </div>
		  
		  
		  <div id="music163player">
			<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1428784488&auto=1&height=66"></iframe>
		  </div>
		  
          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                å‹æƒ…é“¾æ¥
              </div>
        
			  
                <span class="links-of-author-item" style="text-align: left">
                  <a href="https://leetcode-cn.com/" title="leetcode" target="_blank" rel="external nofollow">leetcode</a>
                </span>
              
                <span class="links-of-author-item" style="text-align: left">
                  <a href="https://gitee.com/dufu-03-13/" title="ç äº‘" target="_blank" rel="external nofollow">ç äº‘</a>
                </span>
              
                <span class="links-of-author-item" style="text-align: left">
                  <a href="http://www.alloyteam.com/nav/" title="Webå‰ç«¯å¯¼èˆª" target="_blank" rel="external nofollow">Webå‰ç«¯å¯¼èˆª</a>
                </span>
              
                <span class="links-of-author-item" style="text-align: left">
                  <a href="http://www.36zhen.com/t?id=3448" title="å‰ç«¯ä¹¦ç±èµ„æ–™" target="_blank" rel="external nofollow">å‰ç«¯ä¹¦ç±èµ„æ–™</a>
                </span>
              
                <span class="links-of-author-item" style="text-align: left">
                  <a href="http://ife.baidu.com/" title="ç™¾åº¦å‰ç«¯æŠ€æœ¯å­¦é™¢" target="_blank" rel="external nofollow">ç™¾åº¦å‰ç«¯æŠ€æœ¯å­¦é™¢</a>
                </span>
              
                <span class="links-of-author-item" style="text-align: left">
                  <a href="http://wf.uisdc.com/cn/" title="googleå‰ç«¯å¼€å‘åŸºç¡€" target="_blank" rel="external nofollow">googleå‰ç«¯å¼€å‘åŸºç¡€</a>
                </span>
              
		  <div id="days"></div>
<script>
function show_date_time(){
window.setTimeout("show_date_time()",1000);
BirthDay=new Date("06/01/2020 15:13:14");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="å·²è¿è¡Œ"+daysold+"å¤©"+hrsold+"å°æ—¶"+minsold+"åˆ†"+seconds+"ç§’";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>


            </div>
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ğŸŒ¸requestçˆ¬è™«å…¥é—¨"><span class="nav-number">1.</span> <span class="nav-text">ğŸŒ¸requestçˆ¬è™«å…¥é—¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®€å•çš„ç½‘é¡µç»“æ„"><span class="nav-number">1.1.</span> <span class="nav-text">ç®€å•çš„ç½‘é¡µç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”¨-Python-ç™»å½•ç½‘é¡µ"><span class="nav-number">1.2.</span> <span class="nav-text">ç”¨ Python ç™»å½•ç½‘é¡µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ¹é…ç½‘é¡µå†…å®¹"><span class="nav-number">1.3.</span> <span class="nav-text">åŒ¹é…ç½‘é¡µå†…å®¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BeautifulSoupåŸºç¡€"><span class="nav-number">1.4.</span> <span class="nav-text">BeautifulSoupåŸºç¡€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSS"><span class="nav-number">1.5.</span> <span class="nav-text">CSS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CSS-çš„-Class"><span class="nav-number">1.5.1.</span> <span class="nav-text">CSS çš„ Class</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æŒ‰-Class-åŒ¹é…"><span class="nav-number">1.5.2.</span> <span class="nav-text">æŒ‰ Class åŒ¹é…</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åµŒå…¥æ­£åˆ™"><span class="nav-number">1.6.</span> <span class="nav-text">åµŒå…¥æ­£åˆ™</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ­£åˆ™åŒ¹é…"><span class="nav-number">1.6.1.</span> <span class="nav-text">æ­£åˆ™åŒ¹é…</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#çˆ¬ç™¾åº¦ç™¾ç§‘"><span class="nav-number">1.7.</span> <span class="nav-text">çˆ¬ç™¾åº¦ç™¾ç§‘</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç™¾åº¦ç™¾ç§‘"><span class="nav-number">1.7.1.</span> <span class="nav-text">ç™¾åº¦ç™¾ç§‘</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è§‚çœ‹è§„å¾‹"><span class="nav-number">1.7.2.</span> <span class="nav-text">è§‚çœ‹è§„å¾‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ¶ä½œçˆ¬è™«"><span class="nav-number">1.7.3.</span> <span class="nav-text">åˆ¶ä½œçˆ¬è™«</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#requests"><span class="nav-number">1.8.</span> <span class="nav-text">requests</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è·å–ç½‘é¡µçš„æ–¹å¼"><span class="nav-number">1.8.1.</span> <span class="nav-text">è·å–ç½‘é¡µçš„æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#requests-get-è¯·æ±‚"><span class="nav-number">1.8.2.</span> <span class="nav-text">requests get è¯·æ±‚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#requests-post-è¯·æ±‚"><span class="nav-number">1.8.3.</span> <span class="nav-text">requests post è¯·æ±‚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸Šä¼ å›¾ç‰‡"><span class="nav-number">1.8.4.</span> <span class="nav-text">ä¸Šä¼ å›¾ç‰‡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç™»å½•"><span class="nav-number">1.8.5.</span> <span class="nav-text">ç™»å½•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨-Session-ç™»å½•"><span class="nav-number">1.8.6.</span> <span class="nav-text">ä½¿ç”¨ Session ç™»å½•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½æ–‡ä»¶"><span class="nav-number">1.9.</span> <span class="nav-text">ä¸‹è½½æ–‡ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#èƒŒæ™¯"><span class="nav-number">1.9.1.</span> <span class="nav-text">èƒŒæ™¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨-urlretrieve"><span class="nav-number">1.9.2.</span> <span class="nav-text">ä½¿ç”¨ urlretrieve</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨-request"><span class="nav-number">1.9.3.</span> <span class="nav-text">ä½¿ç”¨ request</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½ç¾å›½åœ°å›¾"><span class="nav-number">1.10.</span> <span class="nav-text">ä¸‹è½½ç¾å›½åœ°å›¾</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ‰¾åˆ°å›¾ç‰‡ä½ç½®"><span class="nav-number">1.10.1.</span> <span class="nav-text">æ‰¾åˆ°å›¾ç‰‡ä½ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸‹è½½å›¾ç‰‡"><span class="nav-number">1.10.2.</span> <span class="nav-text">ä¸‹è½½å›¾ç‰‡</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼"><span class="nav-number">1.11.</span> <span class="nav-text">åŠ é€Ÿçˆ¬è™«ï¼šå¤šè¿›ç¨‹åˆ†å¸ƒå¼</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«"><span class="nav-number">1.11.1.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çˆ¬è™«</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«"><span class="nav-number">1.11.2.</span> <span class="nav-text">æˆ‘ä»¬çš„åˆ†å¸ƒå¼çˆ¬è™«</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æµ‹è¯•æ™®é€šçˆ¬æ³•"><span class="nav-number">1.11.3.</span> <span class="nav-text">æµ‹è¯•æ™®é€šçˆ¬æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•"><span class="nav-number">1.11.4.</span> <span class="nav-text">æµ‹è¯•åˆ†å¸ƒå¼çˆ¬æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½"><span class="nav-number">1.12.</span> <span class="nav-text">åŠ é€Ÿçˆ¬è™«ï¼šå¼‚æ­¥åŠ è½½</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Asyncio-åº“"><span class="nav-number">1.12.1.</span> <span class="nav-text">Asyncio åº“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºæœ¬ç”¨æ³•"><span class="nav-number">1.12.2.</span> <span class="nav-text">åŸºæœ¬ç”¨æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#aiohttp"><span class="nav-number">1.12.3.</span> <span class="nav-text">aiohttp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”"><span class="nav-number">1.12.4.</span> <span class="nav-text">å’Œå¤šè¿›ç¨‹åˆ†å¸ƒå¼çˆ¬è™«å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é«˜çº§çˆ¬è™«ï¼šè®©-Selenium-æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬"><span class="nav-number">1.13.</span> <span class="nav-text">é«˜çº§çˆ¬è™«ï¼šè®© Selenium æ§åˆ¶ä½ çš„æµè§ˆå™¨å¸®ä½ çˆ¬</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">1.13.1.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶"><span class="nav-number">1.13.2.</span> <span class="nav-text">å·æ‡’çš„ç«ç‹æµè§ˆå™¨æ’ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Python-æ§åˆ¶æµè§ˆå™¨"><span class="nav-number">1.13.3.</span> <span class="nav-text">Python æ§åˆ¶æµè§ˆå™¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é«˜çº§çˆ¬è™«-é«˜æ•ˆæ— å¿§çš„-Scrapy-çˆ¬è™«åº“"><span class="nav-number">1.13.4.</span> <span class="nav-text">é«˜çº§çˆ¬è™«: é«˜æ•ˆæ— å¿§çš„ Scrapy çˆ¬è™«åº“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Scrapy-çš„ä¼˜åŠ¿"><span class="nav-number">1.13.5.</span> <span class="nav-text">Scrapy çš„ä¼˜åŠ¿</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Scrapy-çˆ¬è™«"><span class="nav-number">1.13.6.</span> <span class="nav-text">Scrapy çˆ¬è™«</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2020 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">äº‘æ¾ˆ</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">226.5k</span>
  
  
   <span style="margin-left:8px;">
   <script src="http://s6.cnzz.com/stat.php?id=1278978367&web_id=1278978367" type="text/javascript"></script>
   </span>

</div>










<div class="weixin-box">
  <div class="weixin-menu">
    <div class="weixin-hover">
      <div class="weixin-description">å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œè®¢é˜…æœ¬åšå®¢</div>
    </div>
  </div>
</div>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">åšå®¢å…¨ç«™å…±226.5kå­—</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>








  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1278978367&web_id=1278978367" language="JavaScript"></script>
  </div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("ToKAq6EqsKrh3oh1kL7AwHkb-9Nh9j0Va", "Jjb4SKFne0eAr0pwOARr8X21");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "default";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "default";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "topRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  

  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1278978367&web_id=1278978367" language="JavaScript"></script>
  </div>



  
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":150,"height":300,"left":120},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
<!-- Ò³ï¿½ï¿½ï¿½ï¿½Ğ¡ï¿½ï¿½ï¿½ï¿½ -->
<script type="text/javascript" src="/js/src/love.js"></script>
